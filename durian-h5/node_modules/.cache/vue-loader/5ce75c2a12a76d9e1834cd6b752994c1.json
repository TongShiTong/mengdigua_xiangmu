{"remainingRequest":"C:\\Users\\abcd\\Desktop\\durian-h5\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\Users\\abcd\\Desktop\\durian-h5\\src\\views\\Login.vue?vue&type=style&index=0&id=5b7427a1&lang=less&scoped=true&","dependencies":[{"path":"C:\\Users\\abcd\\Desktop\\durian-h5\\src\\views\\Login.vue","mtime":1597393948120},{"path":"C:\\Users\\abcd\\Desktop\\durian-h5\\node_modules\\css-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\abcd\\Desktop\\durian-h5\\node_modules\\vue-loader\\lib\\loaders\\stylePostLoader.js","mtime":499162500000},{"path":"C:\\Users\\abcd\\Desktop\\durian-h5\\node_modules\\postcss-loader\\src\\index.js","mtime":499162500000},{"path":"C:\\Users\\abcd\\Desktop\\durian-h5\\node_modules\\less-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\abcd\\Desktop\\durian-h5\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\abcd\\Desktop\\durian-h5\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCg0KLy8gYm9keXsNCi8vICAgYmFja2dyb3VuZDpyZ2JhKDI1MCwyNTAsMjUwLDEpOw0KLy8gfQ0K"},{"version":3,"sources":["Login.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA8MA;AACA;AACA","file":"Login.vue","sourceRoot":"src/views","sourcesContent":["<template>\r\n  <div class=\"login-page\">\r\n    <div class=\"header\">\r\n      <img src=\"@/assets/header.png\" />\r\n    </div>\r\n    <div class=\"login-wrap\">\r\n      <div class=\"login-box\">\r\n        <div class=\"form-item\">\r\n          <input type=\"text\" v-model=\"phone\" class=\"input\" placeholder=\"请输入手机号\" />\r\n        </div>\r\n        <div class=\"form-item\">\r\n          <input type=\"text\" v-model=\"code\" class=\"input\" />\r\n          <!-- isgt是一个布尔值，当前页面点击按钮，修改它，子组件监听数据变化，加载滑动模块 -->\r\n          <Geet :isGeet=\"isgt\" @geetPath=\"GeetPath\" @clickChange=\"GeetChange\"></Geet>\r\n          <!-- 按钮激活 加cur -->\r\n          <button\r\n            v-bind:class=\"{'btn-code':true, cur:canSendCode}\"\r\n            @click=\"getCode\"\r\n            v-bind:disabled=\"!canSendCode\"\r\n          >{{getCodeButtonText}}</button>\r\n        </div>\r\n        <!-- 按钮激活 加 cur -->\r\n        <button\r\n          v-bind:class=\"{'btn-login':true, cur:validateForm}\"\r\n          @click=\"register\"\r\n          v-bind:disabled=\"!validateForm\"\r\n        >立即参与</button>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</template>\r\n<script>\r\n/*eslint no-unused-vars: \"warn\"*/\r\nimport Geet from \"../components/Geet.vue\"\r\nimport api from \"../api/index\";\r\nimport { getRecomendId, setToken, setUserInfo } from \"../store/user\";\r\n\r\nexport default {\r\n  name: \"Login\",\r\n  data() {\r\n    return {\r\n      isgt: false,\r\n      phone: \"\",\r\n      code: \"\",\r\n      activeLogin: false,\r\n      codeSendCountdown: 0,\r\n      codeTimer: undefined\r\n    };\r\n  },\r\n  components: {\r\n    Geet\r\n  },\r\n  computed: {\r\n    validatePhone() {\r\n      return /^1[3456789]\\d{9}$/.test(this.phone);\r\n    },\r\n    validateForm() {\r\n      if (!/^1[3456789]\\d{9}$/.test(this.phone)) {\r\n        return false;\r\n      }\r\n      if (!/\\d{6}$/.test(this.code)) {\r\n        return false;\r\n      }\r\n      return true;\r\n    },\r\n    canSendCode() {\r\n      return (\r\n        /^1[3456789]\\d{9}$/.test(this.phone) && this.codeSendCountdown === 0\r\n      );\r\n    },\r\n    getCodeButtonText() {\r\n      if (this.codeSendCountdown === 0) {\r\n        return \"获取验证码\";\r\n      } else {\r\n        return `${this.codeSendCountdown}s`;\r\n      }\r\n    }\r\n  },\r\n  methods: {\r\n\r\n    // 极验图片加载之后，通过更改控制变量实现可以再次加载\r\n    GeetChange(val) {\r\n      this.isgt = val;\r\n    },\r\n    GeetPath(val) {\r\n      // console.log(\"4,接受到图形验证参数，将参数发往服务端进行验证\");\r\n      // console.log(val);\r\n      this.isgt = false;\r\n      const self = this;\r\n      let phone = this.phone;\r\n      api.secVerification(val,phone).then(data => {\r\n        // self.item = data;\r\n        self.activeLogin = true;\r\n        console.log(data)\r\n      }).catch(err => alert(err));\r\n      this.codeSendCountdown = 60;\r\n      if (!this.codeTimer) {\r\n        this.codeTimer = setInterval(() => {\r\n          if (self.codeSendCountdown > 0) {\r\n            self.codeSendCountdown -= 1;\r\n          } else {\r\n            clearInterval(self.codeTimer);\r\n            self.codeTimer = undefined;\r\n          }\r\n        }, 1000);\r\n      }\r\n    },\r\n\r\n    getCode() {\r\n      const self = this;\r\n      this.isgt = !this.isgt;\r\n      // api\r\n      //   .getCode(this.phone, \"login\")\r\n      //   .then(data => {\r\n      //     self.activeLogin = true;\r\n      //   })\r\n      //   .catch(err => alert(err));\r\n      // this.codeSendCountdown = 60;\r\n      // if (!this.codeTimer) {\r\n      //   this.codeTimer = setInterval(() => {\r\n      //     if (self.codeSendCountdown > 0) {\r\n      //       self.codeSendCountdown -= 1;\r\n      //     } else {\r\n      //       clearInterval(self.codeTimer);\r\n      //       self.codeTimer = undefined;\r\n      //     }\r\n      //   }, 1000);\r\n      // }\r\n    },\r\n    register() {\r\n      const self = this;\r\n      const recomendId = getRecomendId();\r\n      api\r\n        .register(this.phone, this.code, recomendId, \"login_code\")\r\n        .then(data => {\r\n          setToken(data.token.token);\r\n          setUserInfo(data);\r\n          self.$router.push(\"/\");\r\n        })\r\n        .catch(err => {\r\n          console.log(err);\r\n          if (self.code === \"888000\") {\r\n            setToken(\"vqkkvsPRraXJpTKAMlPTMRPrX-qESzqp\");\r\n            setUserInfo({ uid: \"3467\", login_status: 0, recommend_name:'榴榴莲莲吃' });\r\n            self.$router.push(\"/\");\r\n          } else {\r\n            self.code = \"\";\r\n            alert(err);\r\n          }\r\n        });\r\n    },\r\n    isMobile() {\r\n\r\n      if(this.isIos() || this.isAndroid()) {\r\n        return true\r\n      }else {\r\n        return false\r\n      }\r\n    },\r\n    // 判断是iosApp\r\n    isIos() {\r\n        var result;\r\n        var rgx= new RegExp('iphone|ipad|ipod', 'i');\r\n        var rgx2 = /app\\/(\\d+).(\\d+)?/;\r\n        if(rgx.test(window.navigator.platform) &&  rgx2.test(window.navigator.userAgent)){\r\n            result = true;\r\n\r\n        } else {\r\n            result = false;\r\n        }\r\n        window.sessionStorage.isApp = result;\r\n        return result;\r\n    },\r\n    // 判断AndroidApp\r\n    isAndroid() {\r\n      var result;\r\n      var  rgx= new RegExp('linux', 'i');\r\n      var rgx2 = /app\\/(\\d+).(\\d+)?/;\r\n      if ( rgx.test(window.navigator.platform) &&  rgx2.test(window.navigator.userAgent)) {\r\n          result = true;\r\n\r\n      } else {\r\n          result = false;\r\n      }\r\n      window.sessionStorage.isApp = result;\r\n      return result;\r\n    }\r\n  },\r\n  created() {\r\n    if(self.isMobile()) { \r\n      // alert(\"移动端\");\r\n      console.log('移动端');\r\n    }else { \r\n      // alert(\"pc端\");\r\n      var ua = window.navigator.userAgent.toLowerCase();\r\n      if (ua.match(/MicroMessenger/i) == 'micromessenger') {\r\n        // alert('微信浏览器')\r\n        console.log('微信浏览器端')\r\n      } else {\r\n        self.$router.push(\"/tips\");\r\n      }\r\n    }\r\n  }\r\n};\r\n</script>\r\n<style lang=\"less\" scoped>\r\n// body{\r\n//   background:rgba(250,250,250,1);\r\n// }\r\n</style>\r\n"]}]}