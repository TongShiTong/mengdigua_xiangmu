{"remainingRequest":"C:\\Users\\abcd\\Desktop\\durian-h5\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\Users\\abcd\\Desktop\\durian-h5\\src\\views\\Home.vue?vue&type=script&lang=js&","dependencies":[{"path":"C:\\Users\\abcd\\Desktop\\durian-h5\\src\\views\\Home.vue","mtime":1597750197851},{"path":"C:\\Users\\abcd\\Desktop\\durian-h5\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\abcd\\Desktop\\durian-h5\\node_modules\\babel-loader\\lib\\index.js","mtime":499162500000},{"path":"C:\\Users\\abcd\\Desktop\\durian-h5\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\abcd\\Desktop\\durian-h5\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KDQppbXBvcnQgeyBnZXRUb2tlbiwgZ2V0VXNlckluZm8sIGdldFJlY29tZW5kSWQgfSBmcm9tICIuLi9zdG9yZS91c2VyIjsNCmltcG9ydCBicmlkZ2UgZnJvbSAiLi4vdXRpbHMvYnJpZGdlIjsNCmltcG9ydCBlbnRlciBmcm9tICIuLi91dGlscy9jaGVja0ZpcnN0VGltZSI7DQppbXBvcnQgYXBpIGZyb20gIi4uL2FwaS9pbmRleCI7DQppbXBvcnQgbW9tZW50IGZyb20gJ21vbWVudC9tb21lbnQnDQoNCmV4cG9ydCBkZWZhdWx0IHsNCiAgbmFtZTogIkhvbWUiLA0KICBkYXRhKCkgew0KICAgIHJldHVybiB7DQogICAgICBmaXJzdFRpbWVFbnRlcjogZmFsc2UsDQogICAgICBoYXNUb2tlbjogZmFsc2UsDQogICAgICBwb3BGYWRlOiB0cnVlLA0KICAgICAgc2hvd1BvcDogZmFsc2UsDQogICAgICBzaG93V1hTaGFyZTogZmFsc2UsDQogICAgICByZWNvbW1lbmROYW1lOiAiIiwNCiAgICAgIGl0ZW06IHVuZGVmaW5lZCwNCiAgICAgIGludml0YXRpb25zOiBbXSwNCiAgICAgIG5lZWRJbnZpdGVDb3VudDogNiwNCiAgICAgIGNhblJlY2VpdmVDb3VwYW5Nb25leTogMTcwLA0KICAgICAgaW52YXRlU2hvd0xpc3Q6IFt7fSwge30sIHt9LCB7fSwge30sIHt9LCB7fSwge30sIHt9LCB7fV0sDQogICAgICByZWNlbnRSZWdpc3RlcnM6IFtdLA0KICAgICAgcmFuZG9tUmVnaXN0ZXJUZXh0OiAiIiwNCiAgICAgIGNvdXBhbnM6IFtdLA0KICAgICAgZXZlbnRUaW1lczogW10sDQogICAgICB3YWl0Rm9yRXZlbnQ6IHRydWUsDQogICAgICBjdXJyZW50RXZlbnRJbmRleDogMCwNCiAgICAgIGNvdW50ZG93blRleHQ6ICIiLA0KICAgICAgY291bnRkb3duVGltZXI6IHVuZGVmaW5lZCwNCiAgICAgIHJlZnJlc2hUaW1lcjogdW5kZWZpbmVkDQogICAgfTsNCiAgfSwNCiAgbWV0aG9kczogew0KICAgIHRvTG9naW4oKSB7DQogICAgICBpZiAoYnJpZGdlLmhhc0JyaWRnZSgpKSB7DQogICAgICAgIGJyaWRnZS5zdGFydExvZ2luKCk7DQogICAgICB9IGVsc2Ugew0KICAgICAgICB0aGlzLiRyb3V0ZXIucHVzaCgiL2xvZ2luIik7DQogICAgICB9DQogICAgfSwNCiAgICB0b1J1bGUoKSB7DQogICAgICB0aGlzLiRyb3V0ZXIucHVzaCgiL3J1bGUiKTsNCiAgICB9LA0KICAgIHRvV2VpeGluKCkgew0KICAgICAgaWYgKGJyaWRnZS5oYXNCcmlkZ2UoKSkgew0KICAgICAgICBicmlkZ2Uuc3RhcnRHb29kc0RldGFpbHModGhpcy5pdGVtLnNob3BfaWQsIHRoaXMuaXRlbS5pdGVtX2lkKTsNCiAgICAgIH0gZWxzZSB7DQogICAgICAgIC8vIHRoaXMuJHJvdXRlci5wdXNoKCIvd2VpeGluIik7DQogICAgICAgIGxvY2F0aW9uLmhyZWYgPSAnaHR0cDovL2QubWVuZ2RpZ3VhLmNvbS8nDQogICAgICB9DQogICAgfSwNCiAgICBjbG9zZVBvcEZhZGUoKSB7DQogICAgICB0aGlzLnBvcEZhZGUgPSBmYWxzZTsNCiAgICB9LA0KICAgIHNob3dXWFNoYXJlUG9wRmFkZSgpIHsNCiAgICAgIGlmIChicmlkZ2UuaGFzQnJpZGdlKCkpIHsNCiAgICAgICAgY29uc3QgdGl0bGUgPSAi5oCl77yB5bCx5beu5L2g5LqG77yM5b+r5p2l5biu5oiR5oqi5qa06I6yfiI7DQogICAgICAgIGNvbnN0IGRlc2MgPSAi54K55LiA5LiL5Yqp5Yqb5b6XMTAw5YWD5peg6Zeo5qeb5LyY5oOg5Yi4IjsNCiAgICAgICAgY29uc3QgaW1nVXJsID0NCiAgICAgICAgICAiaHR0cHM6Ly9rb2FsaS5vc3MtY24taGFuZ3pob3UuYWxpeXVuY3MuY29tL19fbGllbWlfXy9pbWFnZS93ZWJwL0FCRlhOVEhLMTIzNDU3ODlfMTU5NDI4MjA0NS53ZWJwIjsNCiAgICAgICAgY29uc3QgcmVjb21lbmRJZCA9IGdldFVzZXJJbmZvKCkudWlkOw0KDQogICAgICAgIC8vIOWumuS5ieWIhuS6q+mTvuaOpSzkvb/nlKhlbmNvZGVVUklDb21wb25lbnTlr7nkvKDlhaXlj4LmlbDnvJbnoIHvvIzpmLLmraLlnKhpT1PkuK3kvKDlhaXlj4LmlbDnvJbnoIHpl67popgNCiAgICAgICAgLy8g5q2k5aSE56S65L6L5Lyg6YCS5Y2V5Liq5Y+C5pWwDQogICAgICAgIGNvbnN0IF9zaGFyZUxpbmsgPQ0KICAgICAgICAgIHdpbmRvdy5sb2NhdGlvbi5vcmlnaW4gKw0KICAgICAgICAgICIvIz8iICsNCiAgICAgICAgICBlbmNvZGVVUklDb21wb25lbnQoInJlY29tZW5kX2lkIikgKw0KICAgICAgICAgICI9IiArDQogICAgICAgICAgZW5jb2RlVVJJQ29tcG9uZW50KHJlY29tZW5kSWQpOw0KICAgICAgICBicmlkZ2Uuc2hhcmVXZWNoYXQodGl0bGUsIGRlc2MsIGltZ1VybCwgX3NoYXJlTGluayk7DQogICAgICB9IGVsc2Ugew0KICAgICAgICB0aGlzLmZpcnN0VGltZUVudGVyID0gZmFsc2U7DQogICAgICAgIHRoaXMuc2hvd1dYU2hhcmUgPSB0cnVlOw0KICAgICAgfQ0KICAgIH0sDQogICAgY2xvc2VXWFNoYXJlUG9wRmFkZSgpIHsNCiAgICAgIHRoaXMuc2hvd1dYU2hhcmUgPSBmYWxzZTsNCiAgICAgIHRoaXMucG9wRmFkZSA9IGZhbHNlOw0KICAgICAgdGhpcy5zaG93UG9wID09IGZhbHNlOw0KICAgIH0sDQogICAgZ2V0SXRlbSgpIHsNCiAgICAgIGNvbnN0IHNlbGYgPSB0aGlzOw0KICAgICAgYXBpLmdldEl0ZW0oMTE0NTg0KS50aGVuKGRhdGEgPT4gew0KICAgICAgICBzZWxmLml0ZW0gPSBkYXRhOw0KICAgICAgICBzZWxmLmdldEV2ZW50VGltZXMoKTsNCiAgICAgIH0pOw0KICAgIH0sDQogICAgZ2V0UmVjZW50UmVnaXN0ZXJzOiBmdW5jdGlvbigpIHsNCiAgICAgIGNvbnN0IHNlbGYgPSB0aGlzOw0KICAgICAgYXBpLmdldFJlY2VudFJlZ2lzdGVycygpLnRoZW4oZGF0YSA9PiB7DQogICAgICAgIHNlbGYucmVjZW50UmVnaXN0ZXJzID0gZGF0YTsNCiAgICAgICAgY29uc3QgcmFuZG9tRWxlbWVudCA9IGRhdGFbTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogZGF0YS5sZW5ndGgpXTsNCiAgICAgICAgdGhpcy5yYW5kb21SZWdpc3RlclRleHQgPSBg55So5oi3JHtyYW5kb21FbGVtZW50Lm5pY2tuYW1lfeW3suWPguS4juS6huaKoui0rWA7DQogICAgICB9KTsNCiAgICB9LA0KICAgIGdldEludml0YXRpb25zOiBmdW5jdGlvbigpIHsNCiAgICAgIGNvbnN0IHNlbGYgPSB0aGlzOw0KICAgICAgYXBpLmdldEludml0YXRpb25zKCkudGhlbihkYXRhID0+IHsNCiAgICAgICAgaWYgKGRhdGEpIHsNCiAgICAgICAgICBzZWxmLmludml0YXRpb25zID0gZGF0YTsNCiAgICAgICAgICBjb25zdCBlbXB0eUxpc3QgPSBbe30sIHt9LCB7fSwge30sIHt9LCB7fSwge30sIHt9LCB7fSwge31dOw0KICAgICAgICAgIGNvbnN0IHNob3dMaXN0ID0gWy4uLnNlbGYuaW52aXRhdGlvbnMsIC4uLmVtcHR5TGlzdF0uc2xpY2UoMCwgMTApOw0KICAgICAgICAgIHNlbGYuaW52YXRlU2hvd0xpc3QgPSBzaG93TGlzdDsNCiAgICAgICAgICBjb25zdCBsZW5ndGggPSBkYXRhLmxlbmd0aDsNCiAgICAgICAgICBpZiAobGVuZ3RoIDwgNikgew0KICAgICAgICAgICAgc2VsZi5uZWVkSW52aXRlQ291bnQgPSA2IC0gbGVuZ3RoOw0KICAgICAgICAgICAgc2VsZi5jYW5SZWNlaXZlQ291cGFuTW9uZXkgPSAxNzA7DQogICAgICAgICAgfSBlbHNlIGlmIChsZW5ndGggPCAxMCkgew0KICAgICAgICAgICAgc2VsZi5uZWVkSW52aXRlQ291bnQgPSAxMCAtIGxlbmd0aDsNCiAgICAgICAgICAgIHNlbGYuY2FuUmVjZWl2ZUNvdXBhbk1vbmV5ID0gMTkwOw0KICAgICAgICAgIH0NCiAgICAgICAgfQ0KICAgICAgfSk7DQogICAgfSwNCiAgICBnZXRDb3VwYW5zOiBmdW5jdGlvbigpIHsNCiAgICAgIGNvbnN0IHNlbGYgPSB0aGlzOw0KICAgICAgYXBpLmdldENvdXBvbnMoMTE0NTg0LCAiaXRlbSIsIDkpLnRoZW4oZGF0YSA9PiB7DQogICAgICAgIHNlbGYuY291cGFucyA9IGRhdGEubGlzdDsNCiAgICAgIH0pOw0KICAgIH0sDQogICAgY2FuUmVjZWl2ZUNvdXBhbjogZnVuY3Rpb24oY291cGFuKSB7DQogICAgICBpZiAoY291cGFuLmRpc2NvdW50X251bSA9PSAxNzApIHsNCiAgICAgICAgcmV0dXJuIHRoaXMuaW52aXRhdGlvbnMubGVuZ3RoID49IDY7DQogICAgICB9DQogICAgICBpZiAoY291cGFuLmRpc2NvdW50X251bSA9PSAxOTApIHsNCiAgICAgICAgcmV0dXJuIHRoaXMuaW52aXRhdGlvbnMubGVuZ3RoID49IDEwOw0KICAgICAgfQ0KICAgICAgcmV0dXJuIHRydWU7DQogICAgfSwNCiAgICByZWNlaXZlQ291cGFuOiBmdW5jdGlvbihjb3VwYW5JZCkgew0KICAgICAgY29uc3Qgc2VsZiA9IHRoaXM7DQogICAgICBhcGkucmVjZWl2ZUNvdXBvbihjb3VwYW5JZCkudGhlbihkYXRhID0+IHsNCiAgICAgICAgc2VsZi5nZXRDb3VwYW5zKCk7DQogICAgICAgIGNvbnNvbGUubG9nKGRhdGEpOw0KICAgICAgfSk7DQogICAgfSwNCiAgICBnZXRFdmVudFRpbWVzOiBmdW5jdGlvbigpIHsNCiAgICAgIGNvbnN0IHNlbGYgPSB0aGlzOw0KICAgICAgYXBpLmdldEV2ZW50VGltZXMoKS50aGVuKGRhdGEgPT4gew0KICAgICAgICBzZWxmLmV2ZW50VGltZXMgPSBkYXRhOw0KICAgICAgICBzZWxmLmdldEN1cnJlbnREYXRlSW5kZXgoKTsNCiAgICAgICAgc2VsZi5zZXRDb3VudGRvd25UaW1lcigpOw0KICAgICAgfSk7DQogICAgfSwNCiAgICBwZWVrRXZlbnRUaW1lczogZnVuY3Rpb24obWFwRXZlbnRUaW1lcywgaW5kZXgpIHsNCiAgICAgIGlmIChpbmRleCArIDEgPj0gbWFwRXZlbnRUaW1lcy5sZW5ndGggLSAxKSB7DQogICAgICAgIHJldHVybiBmYWxzZTsNCiAgICAgIH0gZWxzZSB7DQogICAgICAgIGNvbnN0IGl0ZW0gPSBtYXBFdmVudFRpbWVzW2luZGV4ICsgMV07DQogICAgICAgIGNvbnN0IHRpbWUgPSBEYXRlLnBhcnNlKGl0ZW0pOw0KICAgICAgICBjb25zdCBjdXJyZW50VGltZSA9IG5ldyBEYXRlKCkuZ2V0VGltZSgpOw0KICAgICAgICByZXR1cm4gY3VycmVudFRpbWUgPiB0aW1lOw0KICAgICAgfQ0KICAgIH0sDQogICAgZ2V0Q3VycmVudERhdGVJbmRleDogZnVuY3Rpb24oKSB7DQogICAgICBpZiAodGhpcy5ldmVudFRpbWVzLmxlbmd0aCA+IDApIHsNCiAgICAgICAgbGV0IGluZGV4ID0gMDsNCiAgICAgICAgY29uc3QgbWFwRXZlbnRUaW1lcyA9IHRoaXMuZXZlbnRUaW1lcy5tYXAodCA9PiBgMjAyMC8ke3R9YCk7DQogICAgICAgIGZvciAoY29uc3QgaXRlbSBvZiBtYXBFdmVudFRpbWVzKSB7DQogICAgICAgICAgY29uc3QgdGltZSA9IERhdGUucGFyc2UoaXRlbSk7DQogICAgICAgICAgY29uc3QgY3VycmVudFRpbWUgPSBuZXcgRGF0ZSgpLmdldFRpbWUoKTsNCiAgICAgICAgICBpZiAoY3VycmVudFRpbWUgPCB0aW1lKSB7DQogICAgICAgICAgICBpZiAodGhpcy5pdGVtLnN0b2NrID09PSAwKSB7DQogICAgICAgICAgICAgIGluZGV4ICs9IDE7DQogICAgICAgICAgICB9DQogICAgICAgICAgICBicmVhazsNCiAgICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgaWYgKCF0aGlzLnBlZWtFdmVudFRpbWVzKG1hcEV2ZW50VGltZXMsIGluZGV4KSkgew0KICAgICAgICAgICAgICBpZiAodGhpcy5pdGVtLnN0b2NrID4gMCkgew0KICAgICAgICAgICAgICAgIHRoaXMud2FpdEZvckV2ZW50ID0gZmFsc2U7DQogICAgICAgICAgICAgICAgYnJlYWs7DQogICAgICAgICAgICAgIH0NCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgIGluZGV4ICs9IDE7DQogICAgICAgICAgfQ0KICAgICAgICB9DQogICAgICAgIGlmIChpbmRleCA+IHRoaXMuZXZlbnRUaW1lcy5sZW5ndGggLSAxKSB7DQogICAgICAgICAgaW5kZXggPSB0aGlzLmV2ZW50VGltZXMubGVuZ3RoIC0gMTsNCiAgICAgICAgfQ0KICAgICAgICB0aGlzLmN1cnJlbnRFdmVudEluZGV4ID0gaW5kZXg7DQogICAgICAgIHRoaXMuc2xpY2VFdmVudFRpbWVzKCk7DQogICAgICB9IGVsc2Ugew0KICAgICAgICB0aGlzLmN1cnJlbnRFdmVudEluZGV4ID0gMDsNCiAgICAgIH0NCiAgICB9LA0KICAgIHNsaWNlRXZlbnRUaW1lcygpIHsNCiAgICAgIGlmICh0aGlzLmV2ZW50VGltZXMubGVuZ3RoID4gMCkgew0KICAgICAgICBjb25zdCBpbmRleCA9IHRoaXMuY3VycmVudEV2ZW50SW5kZXg7DQogICAgICAgIGNvbnN0IGxlbmd0aCA9IHRoaXMuZXZlbnRUaW1lcy5sZW5ndGg7DQogICAgICAgIGlmIChpbmRleCArIDQgPD0gbGVuZ3RoIC0gMSkgew0KICAgICAgICAgIHRoaXMuY3VycmVudEV2ZW50SW5kZXggPSAwOw0KICAgICAgICAgIHRoaXMuZXZlbnRUaW1lcyA9IHRoaXMuZXZlbnRUaW1lcy5zbGljZShpbmRleCwgaW5kZXggKyA0KTsNCiAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICBjb25zdCBwYWQgPSBpbmRleCArIDQgLSAobGVuZ3RoIC0gMSk7DQogICAgICAgICAgY29uc3QgbmV3SW5kZXggPSBpbmRleCAtIHBhZDsNCiAgICAgICAgICB0aGlzLmN1cnJlbnRFdmVudEluZGV4ID0gcGFkOw0KICAgICAgICAgIHRoaXMuZXZlbnRUaW1lcyA9IHRoaXMuZXZlbnRUaW1lcy5zbGljZShuZXdJbmRleCwgbmV3SW5kZXggKyA0KTsNCiAgICAgICAgfQ0KICAgICAgfSBlbHNlIHsNCiAgICAgICAgcmV0dXJuIHRoaXMuZXZlbnRUaW1lczsNCiAgICAgIH0NCiAgICB9LA0KICAgIGdldENvdW50ZG93blRleHQ6IGZ1bmN0aW9uKCkgew0KICAgICAgbGV0IHRoYXQgPSB0aGlzDQogICAgICBpZiAodGhpcy53YWl0Rm9yRXZlbnQgJiYgdGhpcy5ldmVudFRpbWVzLmxlbmd0aCA+IDApIHsgICANCiAgICAgICAgbGV0IHRpbWVEYXRhID0gIjIwMjAvIiArIHRoYXQuZXZlbnRUaW1lc1t0aGF0LmN1cnJlbnRFdmVudEluZGV4XTsNCg0KICAgICAgICBsZXQgY3VycmVudFRpbWVkYXRhID0gbmV3IERhdGUodGltZURhdGEpOw0KICAgICAgICBsZXQgdGltZSA9IG1vbWVudChjdXJyZW50VGltZWRhdGEpLnZhbHVlT2YoKTsNCg0KICAgICAgICBjb25zdCBuZXdDdXJyZW50VGltZSA9IG5ldyBEYXRlKCkNCiAgICAgICAgY29uc3QgY3VycmVudFRpbWUgPSBtb21lbnQobmV3Q3VycmVudFRpbWUpLnZhbHVlT2YoKTsNCiAgICAgICAgbGV0IGNvdW50ZG93biA9IHRpbWUgLSBjdXJyZW50VGltZTsNCiAgICAgICAgY29uc3QgaG91ciA9IE1hdGguZmxvb3IoY291bnRkb3duIC8gMzYwMDAwMCk7DQogICAgICAgIGNvdW50ZG93biA9IGNvdW50ZG93biAlIDM2MDAwMDA7DQogICAgICAgIGNvbnN0IG1pbiA9IE1hdGguZmxvb3IoY291bnRkb3duIC8gNjAwMDApOw0KICAgICAgICBjb3VudGRvd24gPSBjb3VudGRvd24gJSA2MDAwMDsNCiAgICAgICAgY29uc3Qgc2Vjb25kID0gTWF0aC5mbG9vcihjb3VudGRvd24gLyAxMDAwKS50b0ZpeGVkKDApOw0KDQogICAgICAgIHRoaXMuY291bnRkb3duVGV4dCA9IGDot53nprvlvIDlp4vov5jliakgPHNwYW4+JHtob3VyfTwvc3Bhbj4g5bCP5pe2IDxzcGFuPiR7bWlufTwvc3Bhbj4g5YiGIDxzcGFuPiR7c2Vjb25kfTwvc3Bhbj4g56eSYDsNCiAgICAgIH0gZWxzZSB7DQogICAgICAgIHRoaXMuY291bnRkb3duVGV4dCA9ICLmraPlnKjmiqLotK3kuK0iOw0KICAgICAgfQ0KICAgIH0sDQogICAgdHJhbnNmb3JtVGltZSh0KXsNCiAgICAgICAgLy/liKnnlKhtb21lbnTlt6XlhbfnlJ/miJBkYXRl5a+56LGhDQogICAgICAgIGxldCBkYXRlID0gbW9tZW50KHQpLnRvRGF0ZSgpDQogICAgICAgIC8v5Y+Y5oiQ56eS57qn5pe26Ze05oizDQogICAgICAgIGNvbnNvbGUubG9nKCdkYXRlMTonKyBkYXRlKQ0KICAgICAgICByZXR1cm4gbW9tZW50KGRhdGUpLnZhbHVlT2YoKQ0KICAgIH0sDQogICAgc3BsaXRUaW1lMDogZnVuY3Rpb24odGltZSkgew0KICAgICAgcmV0dXJuIHRpbWUuc3BsaXQoIiAiKVswXTsNCiAgICB9LA0KICAgIHNwbGl0VGltZTE6IGZ1bmN0aW9uKHRpbWUpIHsNCiAgICAgIHJldHVybiB0aW1lLnNwbGl0KCIgIilbMV07DQogICAgfSwNCiAgICBzZXRDb3VudGRvd25UaW1lcjogZnVuY3Rpb24oKSB7DQogICAgICBpZiAoIXRoaXMuY291bnRkb3duVGltZXIpIHsNCiAgICAgICAgY29uc3Qgc2VsZiA9IHRoaXM7DQogICAgICAgIHRoaXMuY291bnRkb3duVGltZXIgPSBzZXRJbnRlcnZhbCgoKSA9PiB7DQogICAgICAgICAgc2VsZi5nZXRDb3VudGRvd25UZXh0KCk7DQogICAgICAgICAgaWYgKCEoc2VsZi53YWl0Rm9yRXZlbnQgJiYgc2VsZi5ldmVudFRpbWVzLmxlbmd0aCA+IDApKSB7DQogICAgICAgICAgICBjbGVhckludGVydmFsKHNlbGYuY291bnRkb3duVGltZXIpOw0KICAgICAgICAgICAgc2VsZi5jb3VudGRvd25UaW1lciA9IHVuZGVmaW5lZDsNCiAgICAgICAgICB9DQogICAgICAgIH0sIDEwMDApOw0KICAgICAgfQ0KICAgIH0sDQogICAgc2V0UmVmcmVzaFRpbWVyOiBmdW5jdGlvbigpIHsNCiAgICAgIGlmICghdGhpcy5yZWZyZXNoVGltZXIpIHsNCiAgICAgICAgY29uc3Qgc2VsZiA9IHRoaXM7DQogICAgICAgIHRoaXMucmVmcmVzaFRpbWVyID0gc2V0SW50ZXJ2YWwoKCkgPT4gew0KICAgICAgICAgIHNlbGYuaW5pdCgpOw0KICAgICAgICB9LCAxMDAwMCk7DQogICAgICB9DQogICAgfSwNCiAgICBpbml0OiBmdW5jdGlvbigpIHsNCiAgICAgIHRoaXMuZ2V0SXRlbSgpOw0KICAgICAgdGhpcy5nZXRJbnZpdGF0aW9ucygpOw0KICAgICAgdGhpcy5nZXRSZWNlbnRSZWdpc3RlcnMoKTsNCiAgICAgIHRoaXMuZ2V0Q291cGFucygpOw0KICAgICAgaWYgKCF0aGlzLnJlZnJlc2hUaW1lcikgew0KICAgICAgICB0aGlzLnNldFJlZnJlc2hUaW1lcigpOw0KICAgICAgfQ0KICAgIH0sDQogICAgb25TaGFyZSgpIHsNCiAgICAgIC8vIOS8oOWFpeWQjuWPsOetvuWQjVVSTO+8jOWfn+WQjSvlvZPliY3liIbkuqvpobXpnaLot6/lvoQNCiAgICAgIGNvbnN0IF9XWHVybCA9IHdpbmRvdy5sb2NhdGlvbi5vcmlnaW4gKyB3aW5kb3cubG9jYXRpb24ucGF0aG5hbWU7DQoNCiAgICAgIGNvbnN0IHd4ID0gd2luZG93Lnd4Ow0KDQogICAgICAvL+WQkeWQjuWPsOWPkei1t+ivt+axguiOt+W+l2NvbmZpZ+mFjee9ruWPguaVsA0KICAgICAgYXBpDQogICAgICAgIC53eFNoYXJlKF9XWHVybCkNCiAgICAgICAgLnRoZW4oZGF0YSA9PiB7DQogICAgICAgICAgaWYgKGRhdGEpIHsNCiAgICAgICAgICAgIC8vIOivt+axguaOpeWPo+aIkOWKn+WQju+8jA0KICAgICAgICAgICAgLy8g6YWN572uY29uZmlnDQogICAgICAgICAgICB3eC5jb25maWcoew0KICAgICAgICAgICAgICAvLyDlvIDlkK/osIPor5XmqKHlvI/ml7Ys6LCD55So55qE5omA5pyJYXBp55qE6L+U5Zue5YC85Lya5Zyo5a6i5oi356uvYWxlcnTlh7rmnaXvvIzoi6XopoHmn6XnnIvkvKDlhaXnmoTlj4LmlbDvvIzlj6/ku6XlnKhwY+err+aJk+W8gO+8jOWPguaVsOS/oeaBr+S8mumAmui/h2xvZ+aJk+WHuu+8jOS7heWcqHBj56uv5pe25omN5Lya5omT5Y2w44CCDQogICAgICAgICAgICAgIGRlYnVnOiBmYWxzZSwNCiAgICAgICAgICAgICAgLy8g5ZCO5Y+w6L+U5Zue5LmL5YmN6I635Y+W55qEYXBwSWQNCiAgICAgICAgICAgICAgYXBwSWQ6IGRhdGEuYXBwaWQsDQogICAgICAgICAgICAgIC8vIOW/heWhq++8jOeUn+aIkOetvuWQjeeahOaXtumXtOaIsw0KICAgICAgICAgICAgICB0aW1lc3RhbXA6IGRhdGEudGltZXN0YW1wLA0KICAgICAgICAgICAgICAvLyDlv4XloavvvIznlJ/miJDnrb7lkI3nmoTpmo/mnLrkuLINCiAgICAgICAgICAgICAgbm9uY2VTdHI6IGRhdGEubm9uY2VTdHIsDQogICAgICAgICAgICAgIC8vIOW/heWhq++8jOetvuWQje+8jOingemZhOW9lTENCiAgICAgICAgICAgICAgc2lnbmF0dXJlOiBkYXRhLnNpZ25hdHVyZSwNCiAgICAgICAgICAgICAgLy8g5b+F5aGr77yM6ZyA6KaB5L2/55So55qESlPmjqXlj6PliJfooajvvIzmiYDmnIlKU+aOpeWPo+WIl+ihqOingemZhOW9lTMNCiAgICAgICAgICAgICAganNBcGlMaXN0OiBbDQogICAgICAgICAgICAgICAgImNoZWNrSnNBcGkiLA0KICAgICAgICAgICAgICAgICJvbk1lbnVTaGFyZVRpbWVsaW5lIiwNCiAgICAgICAgICAgICAgICAib25NZW51U2hhcmVBcHBNZXNzYWdlIiwNCiAgICAgICAgICAgICAgICAiaGlkZU1lbnVJdGVtcyINCiAgICAgICAgICAgICAgXQ0KICAgICAgICAgICAgfSk7DQoNCiAgICAgICAgICAgIC8vIOW+ruS/oeajgOafpeaOpeWPo+WIl+ihqA0KICAgICAgICAgICAgd3guY2hlY2tKc0FwaSh7DQogICAgICAgICAgICAgIGpzQXBpTGlzdDogWw0KICAgICAgICAgICAgICAgICJvbk1lbnVTaGFyZVRpbWVsaW5lIiwNCiAgICAgICAgICAgICAgICAib25NZW51U2hhcmVBcHBNZXNzYWdlIiwNCiAgICAgICAgICAgICAgICAiaGlkZU1lbnVJdGVtcyINCiAgICAgICAgICAgICAgXSwgLy8g6ZyA6KaB5qOA5rWL55qESlPmjqXlj6PliJfooagNCiAgICAgICAgICAgICAgc3VjY2VzczogZnVuY3Rpb24ocmVzKSB7DQogICAgICAgICAgICAgICAgY29uc29sZS5sb2cocmVzKTsNCiAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgfSk7DQoNCiAgICAgICAgICAgIC8vIOmakOiXj+W+ruS/oeWPs+S4iuinkuW8ueWHuuiPnOWNleS4remDqOWIhuWKn+iDveaMiemSrg0KICAgICAgICAgICAgd3guaGlkZU1lbnVJdGVtcyh7DQogICAgICAgICAgICAgIG1lbnVMaXN0OiBbDQogICAgICAgICAgICAgICAgIm1lbnVJdGVtOnNoYXJlOnFxIiwNCiAgICAgICAgICAgICAgICAibWVudUl0ZW06c2hhcmU6UVpvbmUiLA0KICAgICAgICAgICAgICAgICJtZW51SXRlbTpzaGFyZTp3ZWlib0FwcCIsDQogICAgICAgICAgICAgICAgIm1lbnVJdGVtOmNvcHlVcmwiDQogICAgICAgICAgICAgIF0sIC8vIOimgemakOiXj+eahOiPnOWNlemhue+8jOWPquiDvemakOiXj+KAnOS8oOaSreexu+KAneWSjOKAnOS/neaKpOexu+KAneaMiemSru+8jOaJgOaciW1lbnXpobnop4HpmYTlvZU0DQogICAgICAgICAgICAgIHN1Y2Nlc3M6IGZ1bmN0aW9uKHJlcykgew0KICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKHJlcyk7DQogICAgICAgICAgICAgIH0NCiAgICAgICAgICAgIH0pOw0KDQogICAgICAgICAgICAvLyDpobXpnaLliqDovb3lrozmiJDlkI7nlKjmiLflsLHmnInlj6/og73osIPnlKjlvq7kv6HnmoTliIbkuqvvvIzmiYDku6XlvZPpobXpnaJyZWFkeSDlrozlkI7lsLHliqDovb0NCiAgICAgICAgICAgIHd4LnJlYWR5KGZ1bmN0aW9uKCkgew0KICAgICAgICAgICAgICBjb25zdCB0aXRsZSA9ICLmgKXvvIHlsLHlt67kvaDkuobvvIzlv6vmnaXluK7miJHmiqLmprTojrJ+IjsNCiAgICAgICAgICAgICAgY29uc3QgZGVzYyA9ICLngrnkuIDkuIvliqnlipvlvpcxMDDlhYPml6Dpl6jmp5vkvJjmg6DliLgiOw0KICAgICAgICAgICAgICBjb25zdCBpbWdVcmwgPQ0KICAgICAgICAgICAgICAgICJodHRwczovL2tvYWxpLm9zcy1jbi1oYW5nemhvdS5hbGl5dW5jcy5jb20vX19saWVtaV9fL2ltYWdlL3dlYnAvQUJGWE5USEsxMjM0NTc4OV8xNTk0MjgyMDQ1LndlYnAiOw0KICAgICAgICAgICAgICBjb25zdCByZWNvbWVuZElkID0gZ2V0VXNlckluZm8oKS51aWQ7DQoNCiAgICAgICAgICAgICAgLy8g5a6a5LmJ5YiG5Lqr6ZO+5o6lLOS9v+eUqGVuY29kZVVSSUNvbXBvbmVudOWvueS8oOWFpeWPguaVsOe8luegge+8jOmYsuatouWcqGlPU+S4reS8oOWFpeWPguaVsOe8lueggemXrumimA0KICAgICAgICAgICAgICAvLyDmraTlpITnpLrkvovkvKDpgJLljZXkuKrlj4LmlbANCiAgICAgICAgICAgICAgY29uc3QgX3NoYXJlTGluayA9DQogICAgICAgICAgICAgICAgd2luZG93LmxvY2F0aW9uLm9yaWdpbiArDQogICAgICAgICAgICAgICAgIi8jPyIgKw0KICAgICAgICAgICAgICAgIGVuY29kZVVSSUNvbXBvbmVudCgicmVjb21lbmRfaWQiKSArDQogICAgICAgICAgICAgICAgIj0iICsNCiAgICAgICAgICAgICAgICBlbmNvZGVVUklDb21wb25lbnQocmVjb21lbmRJZCk7DQogICAgICAgICAgICAgIC8vIGFsZXJ0KF9zaGFyZUxpbmspOw0KICAgICAgICAgICAgICAvLyDliIbkuqvliLDmnIvlj4vlnIgNCiAgICAgICAgICAgICAgd3gub25NZW51U2hhcmVUaW1lbGluZSh7DQogICAgICAgICAgICAgICAgLy8g5YiG5Lqr5qCH6aKYDQogICAgICAgICAgICAgICAgdGl0bGU6IHRpdGxlLA0KICAgICAgICAgICAgICAgIC8vIOWIhuS6q+mTvuaOpe+8jOivpemTvuaOpeWfn+WQjeaIlui3r+W+hOW/hemhu+S4juW9k+WJjemhtemdouWvueW6lOeahOWFrOS8l+WPt0pT5a6J5YWo5Z+f5ZCN5LiA6Ie0DQogICAgICAgICAgICAgICAgbGluazogX3NoYXJlTGluaywNCiAgICAgICAgICAgICAgICAvLyDliIbkuqvlm77moIcNCiAgICAgICAgICAgICAgICBpbWdVcmw6IGltZ1VybCwNCiAgICAgICAgICAgICAgICAvLyDnlKjmiLfnoa7orqTliIbkuqvlkI7miafooYznmoTlm57osIPlh73mlbANCiAgICAgICAgICAgICAgICBzdWNjZXNzOiBmdW5jdGlvbigpIHsNCiAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCLliIbkuqvlm57osIPlh73mlbAiKTsNCiAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCJzaGFyZUxpbms9ICIgKyBfc2hhcmVMaW5rKTsNCiAgICAgICAgICAgICAgICAgIC8vIGFsZXJ0KCfliIbkuqvlm57miJDlip/osIPlh73mlbAnKTsNCiAgICAgICAgICAgICAgICB9LA0KICAgICAgICAgICAgICAgIC8vIOeUqOaIt+WPlua2iOWIhuS6q+WQjuaJp+ihjOeahOWbnuiwg+WHveaVsA0KICAgICAgICAgICAgICAgIGNhbmNlbDogZnVuY3Rpb24oKSB7DQogICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygi5Y+W5raI5YiG5Lqr5Zue6LCD5Ye95pWwIik7DQogICAgICAgICAgICAgICAgICAvLyBhbGVydCgn5Y+W5raI5YiG5Lqr5Zue6LCD5Ye95pWwJyk7DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICB9KTsNCg0KICAgICAgICAgICAgICAvLyDliIbkuqvlpb3lj4sNCiAgICAgICAgICAgICAgd3gub25NZW51U2hhcmVBcHBNZXNzYWdlKHsNCiAgICAgICAgICAgICAgICAvLyDliIbkuqvmoIfpopgNCiAgICAgICAgICAgICAgICB0aXRsZTogdGl0bGUsDQogICAgICAgICAgICAgICAgLy8g5YiG5Lqr5o+P6L+wDQogICAgICAgICAgICAgICAgZGVzYzogZGVzYywNCiAgICAgICAgICAgICAgICAvLyDliIbkuqvpk77mjqXvvIzor6Xpk77mjqXln5/lkI3miJbot6/lvoTlv4XpobvkuI7lvZPliY3pobXpnaLlr7nlupTnmoTlhazkvJflj7dKU+WuieWFqOWfn+WQjeS4gOiHtA0KICAgICAgICAgICAgICAgIGxpbms6IF9zaGFyZUxpbmssDQogICAgICAgICAgICAgICAgLy8g5YiG5Lqr5Zu+5qCHDQogICAgICAgICAgICAgICAgaW1nVXJsOiBpbWdVcmwsDQogICAgICAgICAgICAgICAgLy8g55So5oi356Gu6K6k5YiG5Lqr5ZCO5omn6KGM55qE5Zue6LCD5Ye95pWwDQogICAgICAgICAgICAgICAgc3VjY2VzczogZnVuY3Rpb24oKSB7DQogICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygi5YiG5Lqr5aW95Y+L5Zue6LCD5Ye95pWwIik7DQogICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygic2hhcmVMaW5rPSAiICsgX3NoYXJlTGluayk7DQogICAgICAgICAgICAgICAgICAvLyBhbGVydCgn5YiG5Lqr5Zue5aW95Y+L6LCD5Ye95pWwJyk7DQogICAgICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICAgICAvLyDnlKjmiLflj5bmtojliIbkuqvlkI7miafooYznmoTlm57osIPlh73mlbANCiAgICAgICAgICAgICAgICBjYW5jZWw6IGZ1bmN0aW9uKCkgew0KICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coIuWPlua2iOWIhuS6q+WlveWPi+iwg+WHveaVsCIpOw0KICAgICAgICAgICAgICAgICAgLy8gYWxlcnQoJ+WPlua2iOWIhuS6q+Wbnuiwg+WHveaVsCcpOw0KICAgICAgICAgICAgICAgICAgLy8gY29uc29sZS5sb2coJ+WIhuS6q+WbnuWlveWPi+iwg+WHveaVsCcpOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgfSk7DQogICAgICAgICAgICB9KTsNCiAgICAgICAgICAgIC8vIOW+ruS/oemihOWKoOi9veWksei0peWbnuiwgw0KICAgICAgICAgICAgd3guZXJyb3IoZnVuY3Rpb24ocmVzKSB7DQogICAgICAgICAgICAgIGNvbnNvbGUubG9nKHJlcyk7DQogICAgICAgICAgICAgIC8vIGFsZXJ0KCflpLHotKUnKTsNCiAgICAgICAgICAgIH0pOw0KICAgICAgICAgIH0NCiAgICAgICAgfSkNCiAgICAgICAgLmNhdGNoKGVycm9yID0+IHsNCiAgICAgICAgICBjb25zb2xlLmxvZyhlcnJvcik7DQogICAgICAgIH0pOw0KICAgIH0sDQogIA0KICB9LA0KICBjb21wdXRlZDogew0KICAgIGdldEl0ZW1OYW1lOiBmdW5jdGlvbigpIHsNCiAgICAgIGlmICh0aGlzLml0ZW0pIHsNCiAgICAgICAgcmV0dXJuIHRoaXMuaXRlbS50aXRsZTsNCiAgICAgIH0gZWxzZSB7DQogICAgICAgIHJldHVybiAi6ams5p2l6KW/5Lqa54yr5bGx546L5qa06I6yMS4x772eMS4za2ciOw0KICAgICAgfQ0KICAgIH0sDQogICAgZ2V0U3RvY2s6IGZ1bmN0aW9uKCkgew0KICAgICAgaWYgKHRoaXMuaXRlbSkgew0KICAgICAgICByZXR1cm4gdGhpcy5pdGVtLnN0b2NrOw0KICAgICAgfSBlbHNlIHsNCiAgICAgICAgcmV0dXJuIDA7DQogICAgICB9DQogICAgfSwNCiAgICBnZXRQcmVjZW50OiBmdW5jdGlvbigpIHsNCiAgICAgIGlmICh0aGlzLml0ZW0pIHsNCiAgICAgICAgcmV0dXJuIE1hdGgucm91bmQoKHRoaXMuaXRlbS5zdG9jayAvIDUwMCkqMTAwKTsNCiAgICAgIH0gZWxzZSB7DQogICAgICAgIHJldHVybiAxMDA7DQogICAgICB9DQogICAgfSwNCiAgICBnZXRSZWNvbW1lbmROYW1lOiBmdW5jdGlvbigpIHsNCiAgICAgIGlmICh0aGlzLnJlY29tbWVuZE5hbWUubGVuZ3RoIDw9IDQpIHsNCiAgICAgICAgcmV0dXJuIHRoaXMucmVjb21tZW5kTmFtZTsNCiAgICAgIH0gZWxzZSB7DQogICAgICAgIHJldHVybiB0aGlzLnJlY29tbWVuZE5hbWUuc2xpY2UoMCwgMykgKyAiLi4uIjsNCiAgICAgIH0NCiAgICB9DQogIH0sDQogIGNyZWF0ZWQ6IGZ1bmN0aW9uKCkgew0KICAgIGNvbnN0IHNlbGYgPSB0aGlzOw0KICAgIGNvbnN0IHJlY29tZW5kSWQgPSBnZXRSZWNvbWVuZElkKCk7DQogICAgY29uc29sZS5sb2cocmVjb21lbmRJZCkNCiAgICBpZihyZWNvbWVuZElkPT0nMTIzJykgew0KICAgICAgdGhpcy5zaG93UG9wID09IGZhbHNlDQogICAgfWVsc2Ugew0KICAgICAgdGhpcy5zaG93UG9wID09IHRydWUNCiAgICB9DQogICAgaWYgKCFyZWNvbWVuZElkKSB7DQogICAgICB0aGlzLmNsb3NlUG9wRmFkZSgpOw0KICAgIH0NCg0KICAgIGZ1bmN0aW9uIGluaXQoKSB7DQogICAgICBjb25zdCB0b2tlbiA9IGdldFRva2VuKCk7DQogICAgICBjb25zb2xlLmxvZyh0b2tlbikNCiAgICAgIGlmICh0b2tlbikgew0KICAgICAgICAgdmFyIHVhID0gd2luZG93Lm5hdmlnYXRvci51c2VyQWdlbnQudG9Mb3dlckNhc2UoKTsNCiAgICAgICAgaWYgKGVudGVyLmdldEZpcnN0VGltZUVudGVyKCkpIHsNCiAgICAgICAgICBzZWxmLmZpcnN0VGltZUVudGVyID0gdHJ1ZTsNCiAgICAgICAgICBlbnRlci5zZXRFbnRlcigpOw0KICAgICAgICAgIGNvbnN0IHVzZXJJbmZvID0gZ2V0VXNlckluZm8oKTsNCiAgICAgICAgICBpZiAodXNlckluZm8ucmVjb21tZW5kX25hbWUpIHsNCiAgICAgICAgICAgIHNlbGYucmVjb21tZW5kTmFtZSA9IHVzZXJJbmZvLnJlY29tbWVuZF9uYW1lOw0KICAgICAgICAgIH0NCiAgICAgICAgICBpZiAoDQogICAgICAgICAgICB1c2VySW5mby5sb2dpbl9zdGF0dXMgIT0gdW5kZWZpbmVkICYmDQogICAgICAgICAgICB1c2VySW5mby5sb2dpbl9zdGF0dXMgPT09IDENCiAgICAgICAgICApIHsNCiAgICAgICAgICAgIHNlbGYuY2xvc2VQb3BGYWRlKCk7DQogICAgICAgICAgICAvLyBhbGVydCgi5oKo5bey5piv6ICB55So5oi377yM5b+r5Y675Y+C5Yqg5rS75Yqo5ZCnIik7DQogICAgICAgICAgfQ0KICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgIHNlbGYuY2xvc2VQb3BGYWRlKCk7DQogICAgICAgIH0NCiAgICAgICAgc2VsZi5oYXNUb2tlbiA9IHRydWU7DQogICAgICAgIHNlbGYuaW5pdCgpOw0KICAgICAgICBzZWxmLm9uU2hhcmUoKTsNCiAgICAgIH0gZWxzZSB7DQogICAgICAgIC8vIGlmICghcmVjb21lbmRJZCkgew0KICAgICAgICAgIHNlbGYudG9Mb2dpbigpOw0KICAgICAgICAvLyB9DQogICAgICB9DQogICAgDQogICAgfQ0KICAgIGlmIChicmlkZ2UuaGFzQnJpZGdlKCkpIHsNCiAgICAgIGJyaWRnZS5nZXRVc2VySW5mbyhpbml0KTsNCiAgICB9IGVsc2Ugew0KICAgICAgaW5pdCgpOw0KICAgICAgdmFyIHVhID0gd2luZG93Lm5hdmlnYXRvci51c2VyQWdlbnQudG9Mb3dlckNhc2UoKTsNCiAgICAgIGlmICh1YS5tYXRjaCgvTWljcm9NZXNzZW5nZXIvaSkgPT0gJ21pY3JvbWVzc2VuZ2VyJykgew0KICAgICAgDQogICAgICB9IGVsc2Ugew0KICAgICAgICAvLyBzZWxmLiRyb3V0ZXIucHVzaCgiL3RpcHMiKTsNCiAgICAgIH0NCiAgICB9DQogIH0sDQogIGJlZm9yZURlc3Ryb3koKSB7DQogICAgbGV0IHNlbGYgPSB0aGlzDQogICAgaWYoIHNlbGYucmVmcmVzaFRpbWVyICkgew0K44CA44CA44CA44CAY2xlYXJJbnRlcnZhbCggc2VsZi5yZWZyZXNoVGltZXIgKTsgDQrjgIDjgIAgfQ0KICAgIGlmKCBzZWxmLmNvdW50ZG93blRpbWVyICkgew0KICAgICAgY2xlYXJJbnRlcnZhbCggc2VsZi5jb3VudGRvd25UaW1lciApOw0KICAgIH0NCiAgfQ0KfTsNCg=="},{"version":3,"sources":["Home.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAqMA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"Home.vue","sourceRoot":"src/views","sourcesContent":["<template>\r\n  <div class=\"home-page\">\r\n    <div>\r\n      <!-- <div class=\"top-bar\">活动专题</div> -->\r\n      <div class=\"header\">\r\n        <img src=\"@/assets/header.png\" />\r\n        <div class=\"rules\" @click=\"toRule\">活动细则</div>\r\n      </div>\r\n\r\n      <ul class=\"time clearfix\">\r\n        <li\r\n          v-for=\"(item, index) in eventTimes\"\r\n          :key=\"index\"\r\n          v-bind:class=\"{ cur: index === currentEventIndex }\"\r\n        >\r\n          <p v-if=\"index === currentEventIndex && waitForEvent\">即将开抢</p>\r\n          <p v-if=\"index === currentEventIndex && !waitForEvent\">正在开抢</p>\r\n          {{ splitTime0(item) }}\r\n          <br />\r\n          {{ splitTime1(item) }}\r\n        </li>\r\n      </ul>\r\n      <div class=\"page-content\">\r\n        <!-- 下单 -->\r\n        <div class=\"path1\">\r\n          <div class=\"steps\">\r\n            邀请新朋友\r\n            <span>>></span>人满得优惠券\r\n            <span>>></span>下单使用\r\n          </div>\r\n          <div class=\"path-box\">\r\n            <div class=\"ending-time\">\r\n              <div v-html=\"countdownText\"></div>\r\n              <!-- 抢购中 progress-bar 加on -->\r\n              <!-- <div class=\"progress-bar on\"> -->\r\n              <div class=\"progress-bar\">\r\n                <!-- cur 的进度是0~100% -->\r\n                <div class=\"cur\" v-bind:style=\"{ width: getPrecent + '%' }\"></div>\r\n\r\n                <!-- 抢购结束 把cur的div去掉-->\r\n                <!-- <div class=\"num disabled\">剩余0个</div> -->\r\n                <div class=\"num\">仅剩{{ getStock }}个</div>\r\n              </div>\r\n            </div>\r\n\r\n            <div class=\"goods-box\">\r\n              <div class=\"img\">\r\n                <img v-if=\"item !== undefined\" v-bind:src=\"item.img_url\" />\r\n                <img v-else src=\"@/assets/pic.png\" />\r\n              </div>\r\n              <div class=\"goods-info\">\r\n                <div class=\"name\">{{ getItemName }}</div>\r\n                <div class=\"tag\">\r\n                  <span>限时抢购</span>\r\n                  <span>官方补贴</span>\r\n                </div>\r\n                <div class=\"price\">\r\n                  <span class=\"cur\">\r\n                    <i>￥</i>49.8\r\n                  </span>\r\n                  <span class=\"cost\">¥239.8</span>\r\n                </div>\r\n                <!-- 已参与/已售罄状态 加disabled -->\r\n                <!-- <button class=\"btn-buy disabled\">已参与</button> -->\r\n                <button class=\"btn-buy\" @click=\"toWeixin\">马上抢</button>\r\n              </div>\r\n            </div>\r\n\r\n            <div class=\"records-wrap\">\r\n              <p>{{ randomRegisterText }}</p>\r\n              <div class=\"records-list\">\r\n                <ul class=\"list clearfix\">\r\n                  <li v-for=\"(item, index) in recentRegisters\" :key=\"index\">\r\n                    <img v-bind:src=\"item.head_url\" />\r\n                  </li>\r\n                </ul>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n\r\n        <!-- 邀请好友 -->\r\n        <div class=\"path2\">\r\n          <div class=\"item\" v-if=\"needInviteCount < 10\">\r\n            再邀请\r\n            <span>{{ needInviteCount }}</span>名新用户，就能获取\r\n            <span class=\"money\">{{ canReceiveCoupanMoney }}</span>元榴莲优惠券～\r\n          </div>\r\n          <ul class=\"user-list clearfix\">\r\n            <li v-for=\"(item, index) in invateShowList\" :key=\"index\">\r\n              <img v-if=\"item.head_url\" v-bind:src=\"item.head_url\" />\r\n              <i v-if=\"index === 5 || index === 9\" class=\"award\">\r\n                <img src=\"@/assets/award.png\" />\r\n              </i>\r\n            </li>\r\n          </ul>\r\n          <button class=\"btn-invite\" @click=\"showWXSharePopFade\">立即邀请</button>\r\n\r\n          <!-- 优惠券 -->\r\n          <ul class=\"coupon-list\">\r\n            <li v-for=\"(item, index) in coupans\" :key=\"index\">\r\n              <div class=\"box\">\r\n                <span class=\"money\">{{ item.discount_num }}</span>元\r\n              </div>\r\n              {{ item.name }}\r\n              <button v-if=\"item.is_accept\" class=\"btn-coupon\">已领取</button>\r\n              <button\r\n                v-else-if=\"canReceiveCoupan(item)\"\r\n                class=\"btn-coupon\"\r\n                @click=\"receiveCoupan(item.id)\"\r\n              >立即领取</button>\r\n              <button v-else class=\"btn-coupon\" @click=\"showWXSharePopFade\">去邀请</button>\r\n            </li>\r\n          </ul>\r\n        </div>\r\n\r\n        <div class=\"path3\">\r\n          <div class=\"item\">商品详情</div>\r\n          <div class=\"detail-box\">\r\n            <div class=\"pic\">\r\n              <img src=\"@/assets/detail/detail-1.png\" />\r\n            </div>\r\n            <div class=\"pic\">\r\n              <img src=\"@/assets/detail/detail-2.png\" />\r\n            </div>\r\n            <!-- <div class=\"pic\">\r\n              <img src=\"@/assets/detail/detail-3.png\" />\r\n            </div> -->\r\n            <div class=\"pic\">\r\n              <img src=\"@/assets/detail/detail-4.png\" />\r\n            </div>\r\n            <div class=\"pic\">\r\n              <img src=\"@/assets/detail/detail-5.png\" />\r\n            </div>\r\n            <div class=\"pic\">\r\n              <img src=\"@/assets/detail/detail-6.png\" />\r\n            </div>\r\n            <div class=\"pic\">\r\n              <img src=\"@/assets/detail/detail-7.png\" />\r\n            </div>\r\n            <div class=\"pic\">\r\n              <img src=\"@/assets/detail/detail-8.png\" />\r\n            </div>\r\n            <div class=\"pic\">\r\n              <img src=\"@/assets/detail/detail-9.png\" />\r\n            </div>\r\n            <!-- <div class=\"pic\">\r\n              <img src=\"@/assets/detail/detail-10.png\" />\r\n            </div> -->\r\n            <div class=\"pic\">\r\n              <img src=\"@/assets/detail/detail-11.png\" />\r\n            </div>\r\n            <div class=\"pic\">\r\n              <img src=\"@/assets/detail/detail-12.png\" />\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  \r\n    <!-- 当弹窗出现时，向body添加class名为hidden  解决弹窗出现时，页面滚动问题 -->\r\n    <div class=\"pop-fade\" v-show=\"popFade&&showPop\">\r\n      <!-- 弹窗 立即参与-->\r\n      <div class=\"pop-join pop-wrap\" style=\"display:none\">\r\n        <img src=\"@/assets/pop-join.png\" />\r\n        <button class=\"btn-join\"></button>\r\n      </div>\r\n      \r\n      <!-- 弹窗 助力 -->\r\n      <div class=\"pop-help pop-wrap\" v-show=\"!hasToken\">\r\n        <img src=\"@/assets/pop-help.png\" />\r\n        <button class=\"btn-help\" @click=\"toLogin\"></button>\r\n        <button class=\"btn-close\" @click=\"toLogin\"></button>\r\n      </div>\r\n\r\n      <!-- 弹窗 助力成功 -->\r\n      <div class=\"pop-help-ok pop-wrap\" v-show=\"hasToken && firstTimeEnter\">\r\n        <img src=\"@/assets/pop-help-ok.png\" />\r\n        <div class=\"text\">\r\n          <span>{{ getRecommendName }}</span>送你100元猫山王优惠券\r\n        </div>\r\n        <button class=\"btn-ok\" @click=\"closePopFade\"></button>\r\n        <button class=\"btn-close\" @click=\"closePopFade\"></button>\r\n      </div>\r\n    </div>\r\n    <div class=\"pop-fade\" v-show=\"showWXShare\" @click=\"closeWXSharePopFade\">\r\n        <!-- 弹窗 分享链接 -->\r\n      <div class=\"pop-share pop-wrap\">\r\n        <div class=\"pic\">\r\n          <img src=\"@/assets/share.png\" />\r\n        </div>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport { getToken, getUserInfo, getRecomendId } from \"../store/user\";\r\nimport bridge from \"../utils/bridge\";\r\nimport enter from \"../utils/checkFirstTime\";\r\nimport api from \"../api/index\";\r\nimport moment from 'moment/moment'\r\n\r\nexport default {\r\n  name: \"Home\",\r\n  data() {\r\n    return {\r\n      firstTimeEnter: false,\r\n      hasToken: false,\r\n      popFade: true,\r\n      showPop: false,\r\n      showWXShare: false,\r\n      recommendName: \"\",\r\n      item: undefined,\r\n      invitations: [],\r\n      needInviteCount: 6,\r\n      canReceiveCoupanMoney: 170,\r\n      invateShowList: [{}, {}, {}, {}, {}, {}, {}, {}, {}, {}],\r\n      recentRegisters: [],\r\n      randomRegisterText: \"\",\r\n      coupans: [],\r\n      eventTimes: [],\r\n      waitForEvent: true,\r\n      currentEventIndex: 0,\r\n      countdownText: \"\",\r\n      countdownTimer: undefined,\r\n      refreshTimer: undefined\r\n    };\r\n  },\r\n  methods: {\r\n    toLogin() {\r\n      if (bridge.hasBridge()) {\r\n        bridge.startLogin();\r\n      } else {\r\n        this.$router.push(\"/login\");\r\n      }\r\n    },\r\n    toRule() {\r\n      this.$router.push(\"/rule\");\r\n    },\r\n    toWeixin() {\r\n      if (bridge.hasBridge()) {\r\n        bridge.startGoodsDetails(this.item.shop_id, this.item.item_id);\r\n      } else {\r\n        // this.$router.push(\"/weixin\");\r\n        location.href = 'http://d.mengdigua.com/'\r\n      }\r\n    },\r\n    closePopFade() {\r\n      this.popFade = false;\r\n    },\r\n    showWXSharePopFade() {\r\n      if (bridge.hasBridge()) {\r\n        const title = \"急！就差你了，快来帮我抢榴莲~\";\r\n        const desc = \"点一下助力得100元无门槛优惠券\";\r\n        const imgUrl =\r\n          \"https://koali.oss-cn-hangzhou.aliyuncs.com/__liemi__/image/webp/ABFXNTHK12345789_1594282045.webp\";\r\n        const recomendId = getUserInfo().uid;\r\n\r\n        // 定义分享链接,使用encodeURIComponent对传入参数编码，防止在iOS中传入参数编码问题\r\n        // 此处示例传递单个参数\r\n        const _shareLink =\r\n          window.location.origin +\r\n          \"/#?\" +\r\n          encodeURIComponent(\"recomend_id\") +\r\n          \"=\" +\r\n          encodeURIComponent(recomendId);\r\n        bridge.shareWechat(title, desc, imgUrl, _shareLink);\r\n      } else {\r\n        this.firstTimeEnter = false;\r\n        this.showWXShare = true;\r\n      }\r\n    },\r\n    closeWXSharePopFade() {\r\n      this.showWXShare = false;\r\n      this.popFade = false;\r\n      this.showPop == false;\r\n    },\r\n    getItem() {\r\n      const self = this;\r\n      api.getItem(114584).then(data => {\r\n        self.item = data;\r\n        self.getEventTimes();\r\n      });\r\n    },\r\n    getRecentRegisters: function() {\r\n      const self = this;\r\n      api.getRecentRegisters().then(data => {\r\n        self.recentRegisters = data;\r\n        const randomElement = data[Math.floor(Math.random() * data.length)];\r\n        this.randomRegisterText = `用户${randomElement.nickname}已参与了抢购`;\r\n      });\r\n    },\r\n    getInvitations: function() {\r\n      const self = this;\r\n      api.getInvitations().then(data => {\r\n        if (data) {\r\n          self.invitations = data;\r\n          const emptyList = [{}, {}, {}, {}, {}, {}, {}, {}, {}, {}];\r\n          const showList = [...self.invitations, ...emptyList].slice(0, 10);\r\n          self.invateShowList = showList;\r\n          const length = data.length;\r\n          if (length < 6) {\r\n            self.needInviteCount = 6 - length;\r\n            self.canReceiveCoupanMoney = 170;\r\n          } else if (length < 10) {\r\n            self.needInviteCount = 10 - length;\r\n            self.canReceiveCoupanMoney = 190;\r\n          }\r\n        }\r\n      });\r\n    },\r\n    getCoupans: function() {\r\n      const self = this;\r\n      api.getCoupons(114584, \"item\", 9).then(data => {\r\n        self.coupans = data.list;\r\n      });\r\n    },\r\n    canReceiveCoupan: function(coupan) {\r\n      if (coupan.discount_num == 170) {\r\n        return this.invitations.length >= 6;\r\n      }\r\n      if (coupan.discount_num == 190) {\r\n        return this.invitations.length >= 10;\r\n      }\r\n      return true;\r\n    },\r\n    receiveCoupan: function(coupanId) {\r\n      const self = this;\r\n      api.receiveCoupon(coupanId).then(data => {\r\n        self.getCoupans();\r\n        console.log(data);\r\n      });\r\n    },\r\n    getEventTimes: function() {\r\n      const self = this;\r\n      api.getEventTimes().then(data => {\r\n        self.eventTimes = data;\r\n        self.getCurrentDateIndex();\r\n        self.setCountdownTimer();\r\n      });\r\n    },\r\n    peekEventTimes: function(mapEventTimes, index) {\r\n      if (index + 1 >= mapEventTimes.length - 1) {\r\n        return false;\r\n      } else {\r\n        const item = mapEventTimes[index + 1];\r\n        const time = Date.parse(item);\r\n        const currentTime = new Date().getTime();\r\n        return currentTime > time;\r\n      }\r\n    },\r\n    getCurrentDateIndex: function() {\r\n      if (this.eventTimes.length > 0) {\r\n        let index = 0;\r\n        const mapEventTimes = this.eventTimes.map(t => `2020/${t}`);\r\n        for (const item of mapEventTimes) {\r\n          const time = Date.parse(item);\r\n          const currentTime = new Date().getTime();\r\n          if (currentTime < time) {\r\n            if (this.item.stock === 0) {\r\n              index += 1;\r\n            }\r\n            break;\r\n          } else {\r\n            if (!this.peekEventTimes(mapEventTimes, index)) {\r\n              if (this.item.stock > 0) {\r\n                this.waitForEvent = false;\r\n                break;\r\n              }\r\n            }\r\n            index += 1;\r\n          }\r\n        }\r\n        if (index > this.eventTimes.length - 1) {\r\n          index = this.eventTimes.length - 1;\r\n        }\r\n        this.currentEventIndex = index;\r\n        this.sliceEventTimes();\r\n      } else {\r\n        this.currentEventIndex = 0;\r\n      }\r\n    },\r\n    sliceEventTimes() {\r\n      if (this.eventTimes.length > 0) {\r\n        const index = this.currentEventIndex;\r\n        const length = this.eventTimes.length;\r\n        if (index + 4 <= length - 1) {\r\n          this.currentEventIndex = 0;\r\n          this.eventTimes = this.eventTimes.slice(index, index + 4);\r\n        } else {\r\n          const pad = index + 4 - (length - 1);\r\n          const newIndex = index - pad;\r\n          this.currentEventIndex = pad;\r\n          this.eventTimes = this.eventTimes.slice(newIndex, newIndex + 4);\r\n        }\r\n      } else {\r\n        return this.eventTimes;\r\n      }\r\n    },\r\n    getCountdownText: function() {\r\n      let that = this\r\n      if (this.waitForEvent && this.eventTimes.length > 0) {   \r\n        let timeData = \"2020/\" + that.eventTimes[that.currentEventIndex];\r\n\r\n        let currentTimedata = new Date(timeData);\r\n        let time = moment(currentTimedata).valueOf();\r\n\r\n        const newCurrentTime = new Date()\r\n        const currentTime = moment(newCurrentTime).valueOf();\r\n        let countdown = time - currentTime;\r\n        const hour = Math.floor(countdown / 3600000);\r\n        countdown = countdown % 3600000;\r\n        const min = Math.floor(countdown / 60000);\r\n        countdown = countdown % 60000;\r\n        const second = Math.floor(countdown / 1000).toFixed(0);\r\n\r\n        this.countdownText = `距离开始还剩 <span>${hour}</span> 小时 <span>${min}</span> 分 <span>${second}</span> 秒`;\r\n      } else {\r\n        this.countdownText = \"正在抢购中\";\r\n      }\r\n    },\r\n    transformTime(t){\r\n        //利用moment工具生成date对象\r\n        let date = moment(t).toDate()\r\n        //变成秒级时间戳\r\n        console.log('date1:'+ date)\r\n        return moment(date).valueOf()\r\n    },\r\n    splitTime0: function(time) {\r\n      return time.split(\" \")[0];\r\n    },\r\n    splitTime1: function(time) {\r\n      return time.split(\" \")[1];\r\n    },\r\n    setCountdownTimer: function() {\r\n      if (!this.countdownTimer) {\r\n        const self = this;\r\n        this.countdownTimer = setInterval(() => {\r\n          self.getCountdownText();\r\n          if (!(self.waitForEvent && self.eventTimes.length > 0)) {\r\n            clearInterval(self.countdownTimer);\r\n            self.countdownTimer = undefined;\r\n          }\r\n        }, 1000);\r\n      }\r\n    },\r\n    setRefreshTimer: function() {\r\n      if (!this.refreshTimer) {\r\n        const self = this;\r\n        this.refreshTimer = setInterval(() => {\r\n          self.init();\r\n        }, 10000);\r\n      }\r\n    },\r\n    init: function() {\r\n      this.getItem();\r\n      this.getInvitations();\r\n      this.getRecentRegisters();\r\n      this.getCoupans();\r\n      if (!this.refreshTimer) {\r\n        this.setRefreshTimer();\r\n      }\r\n    },\r\n    onShare() {\r\n      // 传入后台签名URL，域名+当前分享页面路径\r\n      const _WXurl = window.location.origin + window.location.pathname;\r\n\r\n      const wx = window.wx;\r\n\r\n      //向后台发起请求获得config配置参数\r\n      api\r\n        .wxShare(_WXurl)\r\n        .then(data => {\r\n          if (data) {\r\n            // 请求接口成功后，\r\n            // 配置config\r\n            wx.config({\r\n              // 开启调试模式时,调用的所有api的返回值会在客户端alert出来，若要查看传入的参数，可以在pc端打开，参数信息会通过log打出，仅在pc端时才会打印。\r\n              debug: false,\r\n              // 后台返回之前获取的appId\r\n              appId: data.appid,\r\n              // 必填，生成签名的时间戳\r\n              timestamp: data.timestamp,\r\n              // 必填，生成签名的随机串\r\n              nonceStr: data.nonceStr,\r\n              // 必填，签名，见附录1\r\n              signature: data.signature,\r\n              // 必填，需要使用的JS接口列表，所有JS接口列表见附录3\r\n              jsApiList: [\r\n                \"checkJsApi\",\r\n                \"onMenuShareTimeline\",\r\n                \"onMenuShareAppMessage\",\r\n                \"hideMenuItems\"\r\n              ]\r\n            });\r\n\r\n            // 微信检查接口列表\r\n            wx.checkJsApi({\r\n              jsApiList: [\r\n                \"onMenuShareTimeline\",\r\n                \"onMenuShareAppMessage\",\r\n                \"hideMenuItems\"\r\n              ], // 需要检测的JS接口列表\r\n              success: function(res) {\r\n                console.log(res);\r\n              }\r\n            });\r\n\r\n            // 隐藏微信右上角弹出菜单中部分功能按钮\r\n            wx.hideMenuItems({\r\n              menuList: [\r\n                \"menuItem:share:qq\",\r\n                \"menuItem:share:QZone\",\r\n                \"menuItem:share:weiboApp\",\r\n                \"menuItem:copyUrl\"\r\n              ], // 要隐藏的菜单项，只能隐藏“传播类”和“保护类”按钮，所有menu项见附录4\r\n              success: function(res) {\r\n                console.log(res);\r\n              }\r\n            });\r\n\r\n            // 页面加载完成后用户就有可能调用微信的分享，所以当页面ready 完后就加载\r\n            wx.ready(function() {\r\n              const title = \"急！就差你了，快来帮我抢榴莲~\";\r\n              const desc = \"点一下助力得100元无门槛优惠券\";\r\n              const imgUrl =\r\n                \"https://koali.oss-cn-hangzhou.aliyuncs.com/__liemi__/image/webp/ABFXNTHK12345789_1594282045.webp\";\r\n              const recomendId = getUserInfo().uid;\r\n\r\n              // 定义分享链接,使用encodeURIComponent对传入参数编码，防止在iOS中传入参数编码问题\r\n              // 此处示例传递单个参数\r\n              const _shareLink =\r\n                window.location.origin +\r\n                \"/#?\" +\r\n                encodeURIComponent(\"recomend_id\") +\r\n                \"=\" +\r\n                encodeURIComponent(recomendId);\r\n              // alert(_shareLink);\r\n              // 分享到朋友圈\r\n              wx.onMenuShareTimeline({\r\n                // 分享标题\r\n                title: title,\r\n                // 分享链接，该链接域名或路径必须与当前页面对应的公众号JS安全域名一致\r\n                link: _shareLink,\r\n                // 分享图标\r\n                imgUrl: imgUrl,\r\n                // 用户确认分享后执行的回调函数\r\n                success: function() {\r\n                  console.log(\"分享回调函数\");\r\n                  console.log(\"shareLink= \" + _shareLink);\r\n                  // alert('分享回成功调函数');\r\n                },\r\n                // 用户取消分享后执行的回调函数\r\n                cancel: function() {\r\n                  console.log(\"取消分享回调函数\");\r\n                  // alert('取消分享回调函数');\r\n                }\r\n              });\r\n\r\n              // 分享好友\r\n              wx.onMenuShareAppMessage({\r\n                // 分享标题\r\n                title: title,\r\n                // 分享描述\r\n                desc: desc,\r\n                // 分享链接，该链接域名或路径必须与当前页面对应的公众号JS安全域名一致\r\n                link: _shareLink,\r\n                // 分享图标\r\n                imgUrl: imgUrl,\r\n                // 用户确认分享后执行的回调函数\r\n                success: function() {\r\n                  console.log(\"分享好友回调函数\");\r\n                  console.log(\"shareLink= \" + _shareLink);\r\n                  // alert('分享回好友调函数');\r\n                },\r\n                // 用户取消分享后执行的回调函数\r\n                cancel: function() {\r\n                  console.log(\"取消分享好友调函数\");\r\n                  // alert('取消分享回调函数');\r\n                  // console.log('分享回好友调函数');\r\n                }\r\n              });\r\n            });\r\n            // 微信预加载失败回调\r\n            wx.error(function(res) {\r\n              console.log(res);\r\n              // alert('失败');\r\n            });\r\n          }\r\n        })\r\n        .catch(error => {\r\n          console.log(error);\r\n        });\r\n    },\r\n  \r\n  },\r\n  computed: {\r\n    getItemName: function() {\r\n      if (this.item) {\r\n        return this.item.title;\r\n      } else {\r\n        return \"马来西亚猫山王榴莲1.1～1.3kg\";\r\n      }\r\n    },\r\n    getStock: function() {\r\n      if (this.item) {\r\n        return this.item.stock;\r\n      } else {\r\n        return 0;\r\n      }\r\n    },\r\n    getPrecent: function() {\r\n      if (this.item) {\r\n        return Math.round((this.item.stock / 500)*100);\r\n      } else {\r\n        return 100;\r\n      }\r\n    },\r\n    getRecommendName: function() {\r\n      if (this.recommendName.length <= 4) {\r\n        return this.recommendName;\r\n      } else {\r\n        return this.recommendName.slice(0, 3) + \"...\";\r\n      }\r\n    }\r\n  },\r\n  created: function() {\r\n    const self = this;\r\n    const recomendId = getRecomendId();\r\n    console.log(recomendId)\r\n    if(recomendId=='123') {\r\n      this.showPop == false\r\n    }else {\r\n      this.showPop == true\r\n    }\r\n    if (!recomendId) {\r\n      this.closePopFade();\r\n    }\r\n\r\n    function init() {\r\n      const token = getToken();\r\n      console.log(token)\r\n      if (token) {\r\n         var ua = window.navigator.userAgent.toLowerCase();\r\n        if (enter.getFirstTimeEnter()) {\r\n          self.firstTimeEnter = true;\r\n          enter.setEnter();\r\n          const userInfo = getUserInfo();\r\n          if (userInfo.recommend_name) {\r\n            self.recommendName = userInfo.recommend_name;\r\n          }\r\n          if (\r\n            userInfo.login_status != undefined &&\r\n            userInfo.login_status === 1\r\n          ) {\r\n            self.closePopFade();\r\n            // alert(\"您已是老用户，快去参加活动吧\");\r\n          }\r\n        } else {\r\n          self.closePopFade();\r\n        }\r\n        self.hasToken = true;\r\n        self.init();\r\n        self.onShare();\r\n      } else {\r\n        // if (!recomendId) {\r\n          self.toLogin();\r\n        // }\r\n      }\r\n    \r\n    }\r\n    if (bridge.hasBridge()) {\r\n      bridge.getUserInfo(init);\r\n    } else {\r\n      init();\r\n      var ua = window.navigator.userAgent.toLowerCase();\r\n      if (ua.match(/MicroMessenger/i) == 'micromessenger') {\r\n      \r\n      } else {\r\n        // self.$router.push(\"/tips\");\r\n      }\r\n    }\r\n  },\r\n  beforeDestroy() {\r\n    let self = this\r\n    if( self.refreshTimer ) {\r\n　　　　clearInterval( self.refreshTimer ); \r\n　　 }\r\n    if( self.countdownTimer ) {\r\n      clearInterval( self.countdownTimer );\r\n    }\r\n  }\r\n};\r\n</script>\r\n"]}]}