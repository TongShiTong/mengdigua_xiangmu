{"version":3,"sources":["webpack:///./src/utils/iosBridge.js","webpack:///./src/utils/bridge.js","webpack:///./src/assets/header.png","webpack:///./src/utils/request.js","webpack:///./src/api/index.js","webpack:///./src/views/Login.vue?661c","webpack:///./src/components/Geet.vue?d0c4","webpack:///src/components/Geet.vue","webpack:///./src/components/Geet.vue?1ab7","webpack:///./src/components/Geet.vue","webpack:///src/views/Login.vue","webpack:///./src/views/Login.vue?09c2","webpack:///./src/views/Login.vue","webpack:///./src/views/Login.vue?ccc0"],"names":["setupWebViewJavascriptBridge","callback","window","WebViewJavascriptBridge","WVJBCallbacks","push","WVJBIframe","document","createElement","style","display","src","documentElement","appendChild","setTimeout","removeChild","callHandler","name","data","bridge","registerHandler","responseCallback","browserInfo","isAndroid","Boolean","navigator","userAgent","match","isiPhone","isWeixin","openInWebview","ua","toLowerCase","undefined","App","iOSBridge","hasBridge","getUserInfo","userInfoStr","userInfo","JSON","parse","setToken","token","setUserInfo","uid","login_status","response","startLogin","console","log","shareWechat","title","content","imgUrl","url","shareWeChat","startGoodsDetails","shopId","itemId","module","exports","service","axios","create","baseURL","timeout","interceptors","request","use","config","getToken","error","Promise","reject","res","errcode","clearToken","location","reload","Error","errmsg","getCode","phone","type","post","register","code","recommend_id","scenario","getItem","item_id","getRecentRegisters","getInvitations","getCoupons","receiveCoupon","ctid","getEventTimes","getRuleContent","id","wxShare","secVerification","val","geetest_challenge","geetest_validate","geetest_seccode","render","_vm","this","_h","$createElement","_c","_self","staticClass","_m","directives","rawName","value","expression","attrs","domProps","on","$event","target","composing","isgt","GeetPath","GeetChange","class","cur","canSendCode","_v","_s","getCodeButtonText","validateForm","staticRenderFns","ref","props","methods","GtCaptcha","_this","computed","created","mounted","watch","isGeet","$refs","btn","click","component","activeLogin","codeSendCountdown","codeTimer","components","Geet","validatePhone","test","api","self","setInterval","clearInterval","$router"],"mappings":"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","file":"js/chunk-2322fc90.be10b001.js","sourcesContent":["function setupWebViewJavascriptBridge(callback) {\r\n  if (window.WebViewJavascriptBridge) {\r\n    return callback(window.WebViewJavascriptBridge);\r\n  }\r\n  if (window.WVJBCallbacks) {\r\n    return window.WVJBCallbacks.push(callback);\r\n  }\r\n  window.WVJBCallbacks = [callback];\r\n  var WVJBIframe = document.createElement(\"iframe\");\r\n  WVJBIframe.style.display = \"none\";\r\n  WVJBIframe.src = \"https://__bridge_loaded__\";\r\n  document.documentElement.appendChild(WVJBIframe);\r\n  setTimeout(function() {\r\n    document.documentElement.removeChild(WVJBIframe);\r\n  }, 0);\r\n}\r\n\r\nexport default {\r\n  callHandler(name, data, callback) {\r\n    setupWebViewJavascriptBridge(function(bridge) {\r\n      bridge.callHandler(name, data, callback);\r\n    });\r\n  },\r\n  registerHandler(name, callback) {\r\n    setupWebViewJavascriptBridge(function(bridge) {\r\n      bridge.registerHandler(name, function(data, responseCallback) {\r\n        callback(data, responseCallback);\r\n      });\r\n    });\r\n  },\r\n};\r\n","import { setUserInfo, setToken } from \"../store/user\";\r\nimport iOSBridge from \"./iosBridge\";\r\n\r\nconst browserInfo = {\r\n  isAndroid: Boolean(navigator.userAgent.match(/android/gi)),\r\n  isiPhone: Boolean(navigator.userAgent.match(/iphone|ipod/gi)),\r\n  isWeixin: Boolean(navigator.userAgent.match(/MicroMessenger/gi)),\r\n};\r\n\r\nfunction openInWebview() {\r\n  var ua = navigator.userAgent.toLowerCase();\r\n  if (ua.match(/MicroMessenger/i) == \"micromessenger\") {\r\n    // 微信浏览器判断\r\n    return false;\r\n  } else if (ua.match(/QQ/i) == \"qq\") {\r\n    // QQ浏览器判断\r\n    return false;\r\n  } else if (ua.match(/WeiBo/i) == \"weibo\") {\r\n    return false;\r\n  } else {\r\n    if (ua.match(/Android/i) != null) {\r\n      return ua.match(/browser/i) == null;\r\n    } else if (ua.match(/iPhone/i) != null) {\r\n      return ua.match(/safari/i) == null;\r\n    } else {\r\n      return ua.match(/macintosh/i) == null && ua.match(/windows/i) == null;\r\n    }\r\n  }\r\n}\r\n\r\nlet bridge = undefined;\r\nif (openInWebview()) {\r\n  bridge = browserInfo.isAndroid ? window.App : iOSBridge;\r\n}\r\n\r\nexport default {\r\n  hasBridge: function() {\r\n    return bridge != undefined;\r\n  },\r\n  isAndroid: function() {\r\n    return browserInfo.isAndroid;\r\n  },\r\n  getUserInfo: function(callback) {\r\n    // const userInfoStr = bridge.getUserInfo();\r\n    // if (userInfoStr) {\r\n    //   const userInfo = JSON.parse(userInfoStr);\r\n    //   if (userInfo) {\r\n    //     setToken(userInfo.token);\r\n    //     setUserInfo({ uid: userInfo.uid, login_status: userInfo.login_status });\r\n    //     callback();\r\n    //   }\r\n    // }\r\n    // callback();\r\n    if (browserInfo.isAndroid) {\r\n      const userInfoStr = bridge.getUserInfo();\r\n      if (userInfoStr) {\r\n        const userInfo = JSON.parse(userInfoStr);\r\n        if (userInfo) {\r\n          setToken(userInfo.token);\r\n          setUserInfo({\r\n            uid: userInfo.uid,\r\n            login_status: userInfo.login_status,\r\n          });\r\n        }\r\n      }\r\n      callback();\r\n    } else if (browserInfo.isiPhone) {\r\n      bridge.callHandler(\"getUserInfo\", {}, (response) => {\r\n        if (response) {\r\n          const userInfo = JSON.parse(response);\r\n          setToken(userInfo.token);\r\n          setUserInfo({\r\n            uid: userInfo.uid,\r\n            login_status: userInfo.login_status,\r\n          });\r\n        }\r\n        callback();\r\n      });\r\n    }\r\n  },\r\n  startLogin: function() {\r\n    // bridge.startLogin();\r\n    if (browserInfo.isAndroid) {\r\n      bridge.startLogin();\r\n    } else if (browserInfo.isiPhone) {\r\n      bridge.callHandler(\"startLogin\", {}, (response) => {\r\n        console.log(response);\r\n      });\r\n    }\r\n  },\r\n  shareWechat: function(title, content, imgUrl, url) {\r\n    // bridge.shareWeChat(title, content, imgUrl, url);\r\n    if (browserInfo.isAndroid) {\r\n      // alert(`title: ${title},content:${content}, imgUrl:${imgUrl}, url:${url}`);\r\n      bridge.shareWeChat(title, content, imgUrl, url);\r\n    } else if (browserInfo.isiPhone) {\r\n      bridge.callHandler(\r\n        \"shareWeChat\",\r\n        { title: title, content: content, imgUrl: imgUrl, url: url },\r\n        (response) => {\r\n          console.log(response);\r\n        }\r\n      );\r\n    }\r\n  },\r\n  startGoodsDetails: function(shopId, itemId) {\r\n    // bridge.startGoodsDetails(shopId, itemId);\r\n    if (browserInfo.isAndroid) {\r\n      bridge.startGoodsDetails(shopId, itemId);\r\n    } else if (browserInfo.isiPhone) {\r\n      bridge.callHandler(\r\n        \"startGoodsDetails\",\r\n        { shopId: shopId, itemId: itemId },\r\n        (response) => {\r\n          console.log(response);\r\n        }\r\n      );\r\n    }\r\n  },\r\n};\r\n","module.exports = __webpack_public_path__ + \"img/header.802af6a0.png\";","import axios from \"axios\";\r\nimport { getToken, clearToken } from \"@/store/user\";\r\n\r\n// create an axios instance\r\nconst service = axios.create({\r\n  baseURL: \"https://api.mengdigua.cn/\", // url = base url + request url\r\n  // withCredentials: true, // send cookies when cross-domain requests\r\n  timeout: 5000, // request timeout\r\n});\r\n\r\n// request interceptor\r\nservice.interceptors.request.use(\r\n  (config) => {\r\n    // do something before request is sent\r\n\r\n    const token = getToken();\r\n    if (token) {\r\n      // let each request carry token\r\n      // ['X-Token'] is a custom headers key\r\n      // please modify it according to the actual situation\r\n      config.data[\"token\"] = token;\r\n    }\r\n    return config;\r\n  },\r\n  (error) => {\r\n    // do something with request error\r\n    console.log(error); // for debug\r\n    return Promise.reject(error);\r\n  }\r\n);\r\n\r\n// response interceptor\r\nservice.interceptors.response.use(\r\n  /**\r\n   * If you want to get http information such as headers or status\r\n   * Please return  response => response\r\n   */\r\n\r\n  /**\r\n   * Determine the request status by custom code\r\n   * Here is just an example\r\n   * You can also judge the status by HTTP Status Code\r\n   */\r\n  (response) => {\r\n    const res = response.data;\r\n\r\n    // if the custom code is not 20000, it is judged as an error.\r\n    if (res.errcode !== 0) {\r\n      // 50008: Illegal token; 50012: Other clients logged in; 50014: Token expired;\r\n      if (\r\n        res.errcode === 50008 ||\r\n        res.errcode === 50012 ||\r\n        res.errcode === 50014 ||\r\n        res.errcode === 10000\r\n      ) {\r\n        // to re-login\r\n        clearToken();\r\n        location.reload();\r\n      }\r\n      return Promise.reject(new Error(res.errmsg || \"Error\"));\r\n    } else {\r\n      return res.data;\r\n    }\r\n  },\r\n  (error) => {\r\n    console.log(\"err\" + error); // for debug\r\n    return Promise.reject(error);\r\n  }\r\n);\r\n\r\nexport default service;\r\n","import request from \"../utils/request\";\r\n\r\nexport default {\r\n  getCode: function(phone, type) {\r\n    return request.post(\"member/user-api/send-sms\", {\r\n      phone: phone,\r\n      type: type,\r\n    });\r\n  },\r\n\r\n  register: function(phone, code, recommend_id, scenario) {\r\n    return request.post(\"member/user-api/login\", {\r\n      phone: phone,\r\n      code: code,\r\n      recommend_id: recommend_id,\r\n      scenario: scenario,\r\n    });\r\n  },\r\n\r\n  getItem: function(item_id) {\r\n    return request.post(\"item/me-item-api/view\", {\r\n      item_id: item_id,\r\n    });\r\n  },\r\n\r\n  getRecentRegisters() {\r\n    return request.post(\"member/user-api/create-desc\", {});\r\n  },\r\n\r\n  getInvitations: function() {\r\n    return request.post(\"member/user-api/invitations\", {});\r\n  },\r\n\r\n  getCoupons: function(item_id, scenario, type) {\r\n    return request.post(\"coupon/coupon-templet-api/item-index\", {\r\n      item_id: item_id,\r\n      scenario: scenario,\r\n      type: type,\r\n    });\r\n  },\r\n\r\n  receiveCoupon: function(ctid) {\r\n    return request.post(\"coupon/coupon-templet-api/receive\", {\r\n      ctid: ctid,\r\n    });\r\n  },\r\n\r\n  getEventTimes: function() {\r\n    return request.post(\"/member/user-api/test-time-list\", {});\r\n  },\r\n\r\n  getRuleContent: function(id) {\r\n    return request.post(\"floor/floor-content-api/get-content\", {\r\n      id: id,\r\n    });\r\n  },\r\n\r\n  wxShare: function(url) {\r\n    return request.post(\"member/user-api/wx-share\", {\r\n      url: url,\r\n    });\r\n  },\r\n  // 二次验证\r\n  secVerification: function(val,phone) {\r\n    return request.post(\"/member/action/second-validate\", {\r\n      geetest_challenge: val.geetest_challenge,\r\n      geetest_validate: val.geetest_validate,\r\n      geetest_seccode: val.geetest_seccode,\r\n      phone: phone\r\n    });\r\n  },\r\n};\r\n","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"login-page\"},[_vm._m(0),_c('div',{staticClass:\"login-wrap\"},[_c('div',{staticClass:\"login-box\"},[_c('div',{staticClass:\"form-item\"},[_c('input',{directives:[{name:\"model\",rawName:\"v-model\",value:(_vm.phone),expression:\"phone\"}],staticClass:\"input\",attrs:{\"type\":\"text\",\"placeholder\":\"请输入手机号\"},domProps:{\"value\":(_vm.phone)},on:{\"input\":function($event){if($event.target.composing){ return; }_vm.phone=$event.target.value}}})]),_c('div',{staticClass:\"form-item\"},[_c('input',{directives:[{name:\"model\",rawName:\"v-model\",value:(_vm.code),expression:\"code\"}],staticClass:\"input\",attrs:{\"type\":\"text\"},domProps:{\"value\":(_vm.code)},on:{\"input\":function($event){if($event.target.composing){ return; }_vm.code=$event.target.value}}}),_c('Geet',{attrs:{\"isGeet\":_vm.isgt},on:{\"geetPath\":_vm.GeetPath,\"clickChange\":_vm.GeetChange}}),_c('button',{class:{'btn-code':true, cur:_vm.canSendCode},attrs:{\"disabled\":!_vm.canSendCode},on:{\"click\":_vm.getCode}},[_vm._v(_vm._s(_vm.getCodeButtonText))])],1),_c('button',{class:{'btn-login':true, cur:_vm.validateForm},attrs:{\"disabled\":!_vm.validateForm},on:{\"click\":_vm.register}},[_vm._v(\"立即参与\")])])])])}\nvar staticRenderFns = [function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"header\"},[_c('img',{attrs:{\"src\":require(\"@/assets/header.png\")}})])}]\n\nexport { render, staticRenderFns }","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',[_c('i',{ref:\"btn\"})])}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\r\n  <div>\r\n    <i ref=\"btn\"></i>\r\n  </div>\r\n</template>\r\n<script>\r\nexport default {\r\n  data() {\r\n    return {};\r\n  },\r\n  //   接受父组件传递的值，用来控制图形验证的加载\r\n  props: [\"isGeet\"],\r\n  methods: {\r\n    GtCaptcha() {\r\n      let _this = this;\r\n      //   此url是极验官网的测试请求地址，加随机数防止缓存\r\n      _this.axios\r\n        .post(\r\n          \"https://api.mengdigua.cn/member/action/first-register?t=\" +\r\n            new Date().getTime()\r\n        )\r\n        .then(res => {\r\n          // console.log(\"1,页面初始化，调用极验接口1，进行图形验证码的加载\");\r\n          // 极验第一次，请求回来的参数\r\n          // console.log(res);\r\n          let data = res.data;\r\n          var handlerEmbed = function(captchaObj) {\r\n            //   图形验证成功\r\n            captchaObj\r\n              .onSuccess(function() {\r\n                var result = captchaObj.getValidate();\r\n                // console.log('123',result)\r\n                let param = {\r\n                  geetest_challenge: result.geetest_challenge,\r\n                  geetest_validate: result.geetest_validate,\r\n                  geetest_seccode: result.geetest_seccode,\r\n                  status: data.success\r\n                };\r\n                // 极验校验的参数，将其传给服务端，进行校验。\r\n                // console.log(\r\n                //   \"3，图形验证通过，将数据传递给父组件，进行服务端验证\"\r\n                // );\r\n                _this.$emit(\"geetPath\", param);\r\n              })\r\n              .onError(function() {\r\n                //   图形验证失败\r\n              });\r\n            //   为此页面的虚拟按钮添加点击事件\r\n            _this.$refs.btn.addEventListener(\"click\", function demo() {\r\n              // 极验图片触发之后，修改控制变量额布尔值，实现再次触发\r\n              _this.$emit(\"clickChange\", false);\r\n              if (_this.isGeet) {\r\n                captchaObj.verify();\r\n              }\r\n            });\r\n          };\r\n          //   初始化极验\r\n          _this.$initGeet(\r\n            {\r\n              gt: data.data.gt,\r\n              challenge: data.data.challenge,\r\n              product: \"bind\",\r\n              offline: !data.data.success,\r\n              https: true\r\n            },\r\n            handlerEmbed\r\n          );\r\n        });\r\n    }\r\n  },\r\n\r\n  computed: {},\r\n\r\n  created() {\r\n    // 页面创建，调用函数\r\n    this.GtCaptcha();\r\n  },\r\n\r\n  mounted() {},\r\n  watch: {\r\n    // 监听参数的变化，调用极验\r\n    isGeet: function() {\r\n      //   这里通过按钮事件调用极验\r\n      this.$refs.btn.click();\r\n    }\r\n  }\r\n};\r\n</script>\r\n<style scoped></style>\r\n","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Geet.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Geet.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./Geet.vue?vue&type=template&id=db7c920a&scoped=true&\"\nimport script from \"./Geet.vue?vue&type=script&lang=js&\"\nexport * from \"./Geet.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"db7c920a\",\n  null\n  \n)\n\nexport default component.exports","<template>\r\n  <div class=\"login-page\">\r\n    <div class=\"header\">\r\n      <img src=\"@/assets/header.png\" />\r\n    </div>\r\n    <div class=\"login-wrap\">\r\n      <div class=\"login-box\">\r\n        <div class=\"form-item\">\r\n          <input type=\"text\" v-model=\"phone\" class=\"input\" placeholder=\"请输入手机号\" />\r\n        </div>\r\n        <div class=\"form-item\">\r\n          <input type=\"text\" v-model=\"code\" class=\"input\" />\r\n          <!-- isgt是一个布尔值，当前页面点击按钮，修改它，子组件监听数据变化，加载滑动模块 -->\r\n          <Geet :isGeet=\"isgt\" @geetPath=\"GeetPath\" @clickChange=\"GeetChange\"></Geet>\r\n          <!-- 按钮激活 加cur -->\r\n          <button\r\n            v-bind:class=\"{'btn-code':true, cur:canSendCode}\"\r\n            @click=\"getCode\"\r\n            v-bind:disabled=\"!canSendCode\"\r\n          >{{getCodeButtonText}}</button>\r\n        </div>\r\n        <!-- 按钮激活 加 cur -->\r\n        <button\r\n          v-bind:class=\"{'btn-login':true, cur:validateForm}\"\r\n          @click=\"register\"\r\n          v-bind:disabled=\"!validateForm\"\r\n        >立即参与</button>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</template>\r\n<script>\r\n/*eslint no-unused-vars: \"warn\"*/\r\nimport Geet from \"../components/Geet.vue\"\r\nimport api from \"../api/index\";\r\nimport bridge from \"../utils/bridge\";\r\nimport { getRecomendId, setToken, setUserInfo } from \"../store/user\";\r\n\r\nexport default {\r\n  name: \"Login\",\r\n  data() {\r\n    return {\r\n      isgt: false,\r\n      phone: \"\",\r\n      code: \"\",\r\n      activeLogin: false,\r\n      codeSendCountdown: 0,\r\n      codeTimer: undefined\r\n    };\r\n  },\r\n  components: {\r\n    Geet\r\n  },\r\n  computed: {\r\n    validatePhone() {\r\n      return /^1[3456789]\\d{9}$/.test(this.phone);\r\n    },\r\n    validateForm() {\r\n      if (!/^1[3456789]\\d{9}$/.test(this.phone)) {\r\n        return false;\r\n      }\r\n      if (!/\\d{6}$/.test(this.code)) {\r\n        return false;\r\n      }\r\n      return true;\r\n    },\r\n    canSendCode() {\r\n      return (\r\n        /^1[3456789]\\d{9}$/.test(this.phone) && this.codeSendCountdown === 0\r\n      );\r\n    },\r\n    getCodeButtonText() {\r\n      if (this.codeSendCountdown === 0) {\r\n        return \"获取验证码\";\r\n      } else {\r\n        return `${this.codeSendCountdown}s`;\r\n      }\r\n    }\r\n  },\r\n  methods: {\r\n\r\n    // 极验图片加载之后，通过更改控制变量实现可以再次加载\r\n    GeetChange(val) {\r\n      this.isgt = val;\r\n    },\r\n    GeetPath(val) {\r\n      // console.log(\"4,接受到图形验证参数，将参数发往服务端进行验证\");\r\n      // console.log(val);\r\n      this.isgt = false;\r\n      const self = this;\r\n      let phone = this.phone;\r\n      api.secVerification(val,phone).then(data => {\r\n        // self.item = data;\r\n        self.activeLogin = true;\r\n        console.log(data)\r\n      }).catch(err => alert(err));\r\n      this.codeSendCountdown = 60;\r\n      if (!this.codeTimer) {\r\n        this.codeTimer = setInterval(() => {\r\n          if (self.codeSendCountdown > 0) {\r\n            self.codeSendCountdown -= 1;\r\n          } else {\r\n            clearInterval(self.codeTimer);\r\n            self.codeTimer = undefined;\r\n          }\r\n        }, 1000);\r\n      }\r\n    },\r\n\r\n    getCode() {\r\n      const self = this;\r\n      this.isgt = !this.isgt;\r\n      // api\r\n      //   .getCode(this.phone, \"login\")\r\n      //   .then(data => {\r\n      //     self.activeLogin = true;\r\n      //   })\r\n      //   .catch(err => alert(err));\r\n      // this.codeSendCountdown = 60;\r\n      // if (!this.codeTimer) {\r\n      //   this.codeTimer = setInterval(() => {\r\n      //     if (self.codeSendCountdown > 0) {\r\n      //       self.codeSendCountdown -= 1;\r\n      //     } else {\r\n      //       clearInterval(self.codeTimer);\r\n      //       self.codeTimer = undefined;\r\n      //     }\r\n      //   }, 1000);\r\n      // }\r\n    },\r\n    register() {\r\n      const self = this;\r\n      const recomendId = getRecomendId();\r\n      api\r\n        .register(this.phone, this.code, recomendId, \"login_code\")\r\n        .then(data => {\r\n          setToken(data.token.token);\r\n          setUserInfo(data);\r\n          self.$router.push(\"/\");\r\n        })\r\n        .catch(err => {\r\n          console.log(err);\r\n          if (self.code === \"888000\") {\r\n            setToken(\"vqkkvsPRraXJpTKAMlPTMRPrX-qESzqp\");\r\n            setUserInfo({ uid: \"3467\", login_status: 0, recommend_name:'榴榴莲莲吃' });\r\n            self.$router.push(\"/\");\r\n          } else {\r\n            self.code = \"\";\r\n            alert(err);\r\n          }\r\n        });\r\n    },\r\n    // isMobile() {\r\n    //   console.log(this.isIos(),this.isAndroid())\r\n    //   if(this.isIos() || this.isAndroid()) {\r\n    //     return true\r\n    //   }else {\r\n    //     return false\r\n    //   }\r\n    // },\r\n    // // 判断是iosApp\r\n    // isIos() {\r\n    //     var result;\r\n    //     var rgx= new RegExp('iphone|ipad|ipod', 'i');\r\n    //     var rgx2 = /app\\/(\\d+).(\\d+)?/;\r\n    //     if(rgx.test(window.navigator.platform) &&  rgx2.test(window.navigator.userAgent)){\r\n    //         result = true;\r\n\r\n    //     } else {\r\n    //         result = false;\r\n    //     }\r\n    //     window.sessionStorage.isApp = result;\r\n    //     return result;\r\n    // },\r\n    // // 判断AndroidApp\r\n    // isAndroid() {\r\n    //   var result;\r\n    //   var  rgx= new RegExp('linux', 'i');\r\n    //   var rgx2 = /app\\/(\\d+).(\\d+)?/;\r\n    //   if ( rgx.test(window.navigator.platform) &&  rgx2.test(window.navigator.userAgent)) {\r\n    //       result = true;\r\n\r\n    //   } else {\r\n    //       result = false;\r\n    //   }\r\n    //   window.sessionStorage.isApp = result;\r\n    //   return result;\r\n    // }\r\n  },\r\n  created() {\r\n    let self = this\r\n    if (bridge.hasBridge()) {\r\n      // bridge.getUserInfo(init);\r\n      console.log('111',bridge.hasBridge())\r\n    } else {\r\n      var ua = window.navigator.userAgent.toLowerCase();\r\n      if (ua.match(/MicroMessenger/i) == 'micromessenger') {\r\n        // alert('微信浏览器')\r\n        console.log('微信浏览器端')\r\n      } else {\r\n        self.$router.push(\"/tips\");\r\n      }\r\n    }\r\n    \r\n  }\r\n};\r\n</script>\r\n<style lang=\"less\" scoped>\r\n// body{\r\n//   background:rgba(250,250,250,1);\r\n// }\r\n</style>\r\n","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Login.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Login.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./Login.vue?vue&type=template&id=4b017abd&scoped=true&\"\nimport script from \"./Login.vue?vue&type=script&lang=js&\"\nexport * from \"./Login.vue?vue&type=script&lang=js&\"\nimport style0 from \"./Login.vue?vue&type=style&index=0&id=4b017abd&lang=less&scoped=true&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"4b017abd\",\n  null\n  \n)\n\nexport default component.exports","import mod from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--10-oneOf-1-0!../../node_modules/css-loader/dist/cjs.js??ref--10-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--10-oneOf-1-2!../../node_modules/less-loader/dist/cjs.js??ref--10-oneOf-1-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Login.vue?vue&type=style&index=0&id=4b017abd&lang=less&scoped=true&\"; export default mod; export * from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--10-oneOf-1-0!../../node_modules/css-loader/dist/cjs.js??ref--10-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--10-oneOf-1-2!../../node_modules/less-loader/dist/cjs.js??ref--10-oneOf-1-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Login.vue?vue&type=style&index=0&id=4b017abd&lang=less&scoped=true&\""],"sourceRoot":""}